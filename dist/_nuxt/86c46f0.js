(window.webpackJsonp=window.webpackJsonp||[]).push([[399,103,185],{1577:function(t,e,n){"use strict";n.r(e);var r=n(114),o=n(133),l=n(87),d=n(518),c=n(875),h=n(1556),m=n(350),_=n(1019),f=n(147),v=n(326),y=n(204),k=n(60),x=n(862),I=n(517),D=n(892),O=n(872),w=n(349),j=n(214),S=n(96),F=n(855),T=n(81),C=(n(35),n(37),n(23)),A=n(3),Y=(n(88),n(215),n(62),n(45),n(80),n(55),n(216),n(33),n(266),{data:function(){var t;return t={dialogFilter:!1,options:{},totalRowsCount:0,formTitle:"New Holiday  ",dialogEmployees:!1,idsEmployeeList:[],datatable_search_textbox:"",filter_employeeid:"",snack:!1,snackColor:"",snackText:"",content:"\n      <h1>Yay Headlines!</h1>\n      <p>All these <strong>cool tags</strong> are working now.</p>\n        ",scrollInvoked:0,start_menu:!1,end_menu:!1,title:"",des:"",desDate:"",dept:""},Object(A.a)(t,"options",{}),Object(A.a)(t,"Model","Holidays"),Object(A.a)(t,"endpoint","holidays"),Object(A.a)(t,"search",""),Object(A.a)(t,"snackbar",!1),Object(A.a)(t,"dialog",!1),Object(A.a)(t,"ids",[]),Object(A.a)(t,"departments",[]),Object(A.a)(t,"loading",!1),Object(A.a)(t,"total",0),Object(A.a)(t,"headers_Dialog",[{text:"Name",align:"left",sortable:!0,value:"first_name"},{text:"Employee Id",align:"left",sortable:!0,value:"employee_id"}]),Object(A.a)(t,"headers",[{text:"Name",align:"left",sortable:!0,key:"name",value:"name"},{text:"Start Date",align:"left",sortable:!0,value:"start_date"},{text:"End Date",align:"left",sortable:!0,value:"end_date"},{text:"Total Days",align:"left",sortable:!0,value:"total_days"},{text:"Actions",align:"center",value:"action",sortable:!1}]),Object(A.a)(t,"editedIndex",-1),Object(A.a)(t,"editedItem",{name:"",total_days:"0",start_date:null,end_date:null,year:null}),Object(A.a)(t,"defaultItem",{name:"",total_days:"",start_date:null,end_date:null,year:null}),Object(A.a)(t,"response",""),Object(A.a)(t,"data",[]),Object(A.a)(t,"errors",[]),Object(A.a)(t,"options_dialog",{}),Object(A.a)(t,"employees_dialog",[]),Object(A.a)(t,"selectAllDepartment",!1),Object(A.a)(t,"selectAllEmployee",!1),Object(A.a)(t,"DialogEmployeesData",{}),Object(A.a)(t,"dataYears",[]),Object(A.a)(t,"filterYear",""),Object(A.a)(t,"branchesList",[]),Object(A.a)(t,"branch_id",""),Object(A.a)(t,"isCompany",!0),t},computed:{},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},created:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){var n,r,o,data,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading=!0,!t.$auth.user.branch_id){e.next=5;break}return t.branch_id=t.$auth.user.branch_id,t.isCompany=!1,e.abrupt("return");case 5:return r=[{text:"Branch",align:"left",sortable:!0,key:"branch_id",value:"branch.branch_name",width:"300px",filterable:!0,filterSpecial:!0}],(n=t.headers).splice.apply(n,[0,0].concat(r)),e.prev=7,e.next=10,t.$axios.get("branches_list",{params:{per_page:100,company_id:t.$auth.user.company_id}});case 10:o=e.sent,data=o.data,t.branchesList=data,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),console.error("Error fetching branch list",e.t0);case 18:l=new Date,t.filterYear=l.getFullYear(),t.getDataFromApi(),t.lastTenYears();case 22:case"end":return e.stop()}}),e,null,[[7,15]])})))()},methods:{filterAttr:function(data){this.editedItem.start_date=data.from,this.editedItem.end_date=data.to,this.filterType="Monthly",this.getDayscount()},lastTenYears:function(){var t=(new Date).getFullYear();this.dataYears=Array.from({length:10},(function(e,i){return t-i}))},getDayscount:function(){if(!this.editedItem.start_date||!this.editedItem.end_date)return!1;var t=new Date(this.editedItem.start_date),e=new Date(this.editedItem.end_date);this.editedItem.year=e.getFullYear();var n=Math.abs(e.getTime()-t.getTime()),r=Math.ceil(n/864e5);this.editedItem.total_days=r+1},can:function(t){return this.$pagePermission.can(t,this)},getDataFromApi:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.endpoint,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";""==e&&(e=this.endpoint),this.loading=!0;var o=this.options,l=o.sortBy,d=o.sortDesc,c=o.page,h=o.itemsPerPage,m={params:{page:c,sortBy:l?l[0]:"",sortDesc:d?d[0]:"",per_page:h,company_id:this.$auth.user.company_id,year:this.filterYear,branch_id:this.branch_id}};""!=n&&(m.params[n]=r),this.$axios.get("".concat(e,"?page=").concat(c),m).then((function(e){var data=e.data;if(""!=n&&0==data.data.length)return t.snack=!0,t.snackColor="error",t.snackText="No Results Found",t.loading=!1,!1;t.data=data.data,t.total=data.total,t.loading=!1,t.totalRowsCount=data.total,t.dialogFilter=!1}))},addItem:function(){this.editedItem={name:"",total_days:"0",start_date:null,end_date:null,year:null},this.isCompany||(this.editedItem.branch_id=this.branch_id),this.dialog=!0},editItem:function(t){this.formTitle="Edit Holidays  ",this.editedIndex=this.data.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},delteteSelectedRecords:function(){var t=this;confirm("Are you sure you wish to delete selected records , to mitigate any inconvenience in future.")&&this.$axios.post("".concat(this.endpoint,"/delete/selected"),{ids:this.ids.map((function(t){return t.id}))}).then((function(e){var data=e.data;data.status?(t.snackbar=data.status,t.ids=[],t.response="Selected records has been deleted"):t.errors=data.errors,t.getDataFromApi()})).catch((function(t){return console.log(t)}))},deleteItem:function(t){var e=this;confirm("Are you sure you wish to delete , to mitigate any inconvenience in future.")&&this.$axios.delete(this.endpoint+"/"+t.id).then((function(t){var data=t.data;data.status?(e.getDataFromApi(),e.snackbar=data.status,e.response=data.message):e.errors=data.errors})).catch((function(t){return console.log(t)}))},close:function(){var t=this;this.dialog=!1,setTimeout((function(){t.editedItem=Object.assign({},t.defaultItem),t.editedIndex=-1}),300)},getEmployees:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"employee";this.loading=!0;var n=this.options,r=n.page,o={params:{per_page:n.itemsPerPage,company_id:this.$auth.user.company_id}};this.$axios.get("".concat(e,"?page=").concat(r),o).then((function(e){var data=e.data;t.employees_dialog=data.data}))},save:function(){var t=this;this.editedItem.company_id=this.$auth.user.company_id,this.editedIndex>-1?this.$axios.put(this.endpoint+"/"+this.editedItem.id,this.editedItem).then((function(e){var data=e.data;if(data.status){var n=t.data.findIndex((function(e){return e.id==t.editedItem.id}));t.data.splice(n,1,{id:t.editedItem.id,name:t.editedItem.name}),t.getDataFromApi(),t.snackbar=data.status,t.response=data.message,t.close()}else t.errors=data.errors})).catch((function(t){return console.log(t)})):this.$axios.post(this.endpoint,this.editedItem).then((function(e){var data=e.data;data.status?(t.getDataFromApi(),t.snackbar=data.status,t.response=data.message,t.close(),t.errors=[],t.search=""):t.errors=data.errors})).catch((function(t){return console.log(t)}))}}}),$=Y,E=n(116),component=Object(E.a)($,(function(){var t=this,e=t._self._c;return t.can("holiday_access")?e("div",[e("div",{staticClass:"text-center ma-2"},[e(O.a,{attrs:{top:"top",color:"secondary",elevation:"24"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n      "+t._s(t.response)+"\n    ")])],1),t._v(" "),e(m.a,{attrs:{width:"300px"},model:{value:t.dialogFilter,callback:function(e){t.dialogFilter=e},expression:"dialogFilter"}},[e(o.a,{attrs:{elevation:"0"}},[e(S.a,{staticClass:"popup_background",attrs:{dense:"",flat:"",dark:""}},[e("span",[t._v(" Select year")]),t._v(" "),e(w.a),t._v(" "),e(f.a,{attrs:{outlined:"",dark:""},on:{click:function(e){t.dialogFilter=!1}}},[t._v("\n          mdi mdi-close-circle\n        ")])],1),t._v(" "),e(_.a,{staticClass:"py-0 my-0"}),t._v(" "),e(l.c,[e(c.a,[e(I.a,[t.isCompany?e(d.a,{attrs:{cols:"12"}},[e(D.a,{attrs:{items:[{id:"",branch_name:"Select All"}].concat(Object(T.a)(t.branchesList)),dense:"",placeholder:"Select Branch",outlined:"","item-value":"id","item-text":"branch_name"},on:{change:function(e){return t.getDataFromApi()}},model:{value:t.branch_id,callback:function(e){t.branch_id=e},expression:"branch_id"}}),t._v(" "),e(D.a,{attrs:{outlined:"",dense:"","x-small":"",items:t.dataYears,placeholder:"Year",solo:"",flat:""},on:{change:function(e){return t.getDataFromApi()}},model:{value:t.filterYear,callback:function(e){t.filterYear=e},expression:"filterYear"}})],1):t._e()],1)],1)],1)],1)],1),t._v(" "),e(m.a,{attrs:{width:"300px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(o.a,[e(l.d,{staticClass:"popup_background",attrs:{dense:""}},[e("h5",[t._v(t._s(t.formTitle))]),t._v(" "),e(w.a),t._v(" "),e(f.a,{attrs:{outlined:"",dark:""},on:{click:function(e){t.dialog=!1}}},[t._v("\n          mdi mdi-close-circle\n        ")])],1),t._v(" "),e(l.c,[e(c.a,[e(I.a,[t.isCompany?e(d.a,{attrs:{cols:"12"}},[e("label",{staticStyle:{"padding-bottom":"5px"},attrs:{for:""}},[t._v("Branches")]),t._v(" "),e(D.a,{attrs:{items:t.branchesList,dense:"",placeholder:"Select Branch",outlined:"","item-value":"id","item-text":"branch_name","hide-details":"","error-messages":t.errors&&t.errors.branch_id?t.errors.branch_id[0]:""},model:{value:t.editedItem.branch_id,callback:function(e){t.$set(t.editedItem,"branch_id",e)},expression:"editedItem.branch_id"}})],1):t._e(),t._v(" "),e(d.a,{attrs:{cols:"12"}},[e("label",{staticStyle:{"padding-bottom":"5px"},attrs:{for:""}},[t._v("Title")]),t._v(" "),e(j.a,{attrs:{dense:"",outlined:"",placeholder:"Title","hide-details":"","error-messages":t.errors&&t.errors.name?t.errors.name[0]:""},model:{value:t.editedItem.name,callback:function(e){t.$set(t.editedItem,"name",e)},expression:"editedItem.name"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12"}},[e("label",{staticStyle:{"padding-bottom":"5px"},attrs:{for:""}},[t._v("Date")]),t._v(" "),e("CustomFilter",{key:t.editedItem.start_date+t.editedItem.end_date,staticStyle:{float:"right",width:"100%","padding-left":"13px"},attrs:{default_date_from:t.editedItem.start_date,default_date_to:t.editedItem.end_date,defaultFilterType:1,height:"45px ",width:"228px"},on:{"filter-attr":t.filterAttr}})],1),t._v(" "),e(d.a,{attrs:{cols:"12"}},[e("label",{attrs:{for:""}},[t._v("Today Days : "+t._s(t.editedItem.total_days))])])],1)],1)],1),t._v(" "),e(l.a,[e(w.a),t._v(" "),e(r.a,{staticClass:"primary",attrs:{small:""},on:{click:t.save}},[t._v("Save")])],1)],1)],1),t._v(" "),e(I.a,[e(d.a,{attrs:{md:"12"}},[e(o.a,{staticClass:"mb-5 mt-2 rounded-md",attrs:{elevation:"0"}},[e(S.a,{staticClass:"rounded-md",attrs:{dense:"",flat:""}},[e(F.b,[e("span",[t._v(" "+t._s(t.Model)+" ")])]),t._v(" "),e("span",[e(r.a,{staticClass:"ma-0 px-0",attrs:{dense:"","x-small":"",ripple:!1,text:"",title:"Reload"}},[e(f.a,{staticClass:"ml-2",attrs:{dark:""},on:{click:function(e){return t.getDataFromApi()}}},[t._v("mdi mdi-reload")])],1)],1),t._v(" "),e("span",[e(r.a,{staticClass:"ma-0 px-0",attrs:{dense:"","x-small":"",ripple:!1,text:"",title:"Select Year"}},[e(f.a,{staticClass:"ml-2",attrs:{dark:""},on:{click:function(e){t.dialogFilter=!0}}},[t._v("mdi mdi-filter")])],1)],1),t._v(" "),e(w.a),t._v(" "),e("span",[e(r.a,{attrs:{"x-small":"",ripple:!1,text:"",title:"Add Holiday"},on:{click:function(e){return t.addItem()}}},[e(f.a,{attrs:{dark:""}},[t._v("mdi-plus-circle")])],1)],1)],1),t._v(" "),e(O.a,{attrs:{timeout:3e3,color:t.snackColor},scopedSlots:t._u([{key:"action",fn:function(n){var o=n.attrs;return[e(r.a,t._b({attrs:{text:""},on:{click:function(e){t.snack=!1}}},"v-btn",o,!1),[t._v(" Close ")])]}}],null,!1,3090489768),model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v("\n          "+t._s(t.snackText)+"\n\n          ")]),t._v(" "),t.can("holiday_view")?e(h.a,{staticClass:"elevation-1",attrs:{"item-key":"id",headers:t.headers,items:t.data,loading:t.loading,"footer-props":{itemsPerPageOptions:[10,50,100,500,1e3]},options:t.options,"server-items-length":t.totalRowsCount},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.name",fn:function(e){var n=e.item;return[t._v("\n            "+t._s(n.name)+"\n          ")]}},{key:"item.start_date",fn:function(e){var n=e.item;return[t._v("\n            "+t._s(t.$dateFormat.format1(n.start_date))+"\n          ")]}},{key:"item.end_date",fn:function(e){var n=e.item;return[t._v("\n            "+t._s(t.$dateFormat.format1(n.end_date))+"\n          ")]}},{key:"item.total_days",fn:function(e){var n=e.item;return[t._v("\n            "+t._s(n.total_days)+"\n          ")]}},{key:"item.action",fn:function(n){var o=n.item;return[e(x.a,{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,l=n.attrs;return[e(r.a,t._g(t._b({attrs:{"dark-2":"",icon:""}},"v-btn",l,!1),o),[e(f.a,[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),t.can("holiday_edit")||t.can("holiday_delete")?e(v.a,{attrs:{width:"120",dense:""}},[t.can("holiday_edit")?e(y.a,{on:{click:function(e){return t.editItem(o)}}},[e(k.c,{staticStyle:{cursor:"pointer"}},[e(f.a,{attrs:{color:"secondary",small:""},on:{click:function(e){return t.editItem(o)}}},[t._v("\n                      mdi-pencil\n                    ")]),t._v("\n                    Edit\n                  ")],1)],1):t._e(),t._v(" "),t.can("holiday_delete")?e(y.a,{on:{click:function(e){return t.deleteItem(o)}}},[e(k.c,{staticStyle:{cursor:"pointer"}},[e(f.a,{attrs:{color:"error",small:""},on:{click:function(e){return t.deleteItem(o)}}},[t._v("\n                      "+t._s("customer"===o.announcement?"":"mdi-delete")+"\n                    ")]),t._v("\n                    Delete\n                  ")],1)],1):t._e()],1):t._e()],1)]}},{key:"no-data",fn:function(){},proxy:!0}],null,!1,946981032),model:{value:t.ids,callback:function(e){t.ids=e},expression:"ids"}}):t._e()],1)],1)],1)],1):e("NoAccess")}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{CustomFilter:n(952).default,NoAccess:n(880).default})},855:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return l}));var r=n(96),o=n(1),l=Object(o.k)("v-toolbar__title"),d=Object(o.k)("v-toolbar__items");r.a},880:function(t,e,n){"use strict";n.r(e);var r=n(116),component=Object(r.a)({},(function(){this._self._c;return this._m(0)}),[function(){var t=this._self._c;return t("div",{staticClass:"text-center",staticStyle:{"margin-top":"25%"}},[t("b",[this._v("No Access")])])}],!1,null,null,null);e.default=component.exports},952:function(t,e,n){"use strict";n.r(e);n(56),n(33),n(266);var r=n(939),o=(n(937),{components:{DatePicker:r.a},props:["defaultFilterType","height","width","default_date_from","default_date_to"],data:function(){return{time3:null,from_date:"",from_menu:!1,to_date:"",to_menu:!1,loading:!1,showTimePanel:!1,filterType:1,search:""}},watch:{filterType:function(){this.showTimePanel=!0,this.FilterData()}},mounted:function(){5==this.filterType&&document.querySelector(".mx-input").focus();var t=document.getElementsByClassName("mx-input");this.height&&""!=this.height&&(t[0].style.height=this.height),this.width&&""!=this.width&&(t[0].style.width=this.width),this.default_date_from&&this.default_date_to&&(this.from_date=this.default_date_from,this.to_date=this.default_date_to),this.time3=[this.from_date,this.to_date]},created:function(){this.defaultFilterType&&(this.filterType=this.defaultFilterType);var t=new Date;this.default_date_from||(this.from_date=t.toISOString().slice(0,10)),this.default_date_to||(this.to_date=t.toISOString().slice(0,10)),this.default_date_from&&this.default_date_to&&(this.from_date=this.default_date_from,this.to_date=this.default_date_to),this.time3=[this.from_date,this.to_date];var data={from:this.from_date,to:this.to_date,type:1,search:"this.search"};this.$emit("filter-attr",data)},methods:{commonMethod:function(){this.from_date&&this.to_date},CustomFilter:function(){if(this.from_date=this.time3[0],this.to_date=this.time3[1],this.from_date&&this.to_date){var data={from:this.from_date,to:this.to_date,type:this.filterType,search:this.search};this.$emit("filter-attr",data)}},FilterData:function(){this.from_date=this.time3[0],this.to_date=this.time3[1];var t=new Date;if(1==this.filterType)this.from_date=t.toISOString().slice(0,10),this.to_date=t.toISOString().slice(0,10);else if(2==this.filterType){var e=new Date;e.setDate(t.getDate()-1),this.from_date=e.toISOString().slice(0,10),this.to_date=e.toISOString().slice(0,10)}else if(3==this.filterType){var n=new Date(t);n.setDate(t.getDate()-t.getDay());var r=new Date(t);r.setDate(t.getDate()-t.getDay()+6),this.from_date=n.toISOString().slice(0,10),this.to_date=r.toISOString().slice(0,10)}else if(4==this.filterType)this.from_date=this.formatDate(new Date(t.getFullYear(),t.getMonth(),1)),this.to_date=this.formatDate(new Date(t.getFullYear(),t.getMonth()+1,0));else if(5==this.filterType)return void(this.time3=[]);if(this.from_date&&this.to_date){var data={from:this.from_date,to:this.to_date,type:this.filterType,search:this.search};this.$emit("filter-attr",data)}},formatDate:function(t){var e=t.getDate(),n=t.getMonth()+1;return t.getFullYear()+"-"+(n<10?"0":"")+n+"-"+(e<10?"0":"")+e}}}),l=n(116),component=Object(l.a)(o,(function(){var t=this;return(0,t._self._c)("date-picker",{attrs:{label:"Date","value-type":"format",format:"YYYY-MM-DD",type:"date",range:""},on:{change:function(e){return t.CustomFilter()}},model:{value:t.time3,callback:function(e){t.time3=e},expression:"time3"}})}),[],!1,null,null,null);e.default=component.exports}}]);