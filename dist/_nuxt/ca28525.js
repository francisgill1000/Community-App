(window.webpackJsonp=window.webpackJsonp||[]).push([[115,92],{1179:function(e,t,n){var content=n(1268);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(21).default)("3453735b",content,!0,{sourceMap:!1})},1267:function(e,t,n){"use strict";n(1179)},1268:function(e,t,n){var o=n(20)((function(i){return i[1]}));o.push([e.i,".v-application--is-ltr .v-data-footer__pagination{margin:0}",""]),o.locals={},e.exports=o},1390:function(e,t,n){"use strict";n.r(t);var o,r=n(117),c=n(539),l=n(1583),m=n(116),d=n(219),f=n(336),v=n(211),_=n(10),h=n(888),y=n(538),w=(n(33),n(12),n(14),n(11),n(18),n(9),n(19),n(17)),k=n(2);n(69),n(70),n(6),n(80),n(31),n(58),n(37),n(41),n(61),n(103),n(543);function O(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function x(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(t){Object(k.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var j={data:function(){return{loading:!1,items:[],emptyLogmessage:"",number_of_records:5,logs:[],url:"ws://192.168.20.100:8080/WebSocket",socket:null,totalRowsCount:0,total:0,options:{},headers_table:[{text:"Pic",align:"left",sortable:!0,filterable:!0,value:"employee.pic"},{text:"Employee Name",align:"left",sortable:!0,filterable:!0,value:"employee.first_name"},{text:"Time",align:"left",sortable:!0,filterable:!0,value:"LogTime"}]}},watch:{options:{handler:function(){this.getRecords()},deep:!0}},mounted:function(){},created:function(){},computed:{employees:function(){return this.$store.state.employeeList.map((function(e){return{system_user_id:e.system_user_id,first_name:e.first_name,last_name:e.last_name,display_name:e.display_name}}))},devices:function(){if(this.$store.state.devices)return this.$store.state.devices.map((function(e){return e.device_id}))}},methods:(o={viewLogs:function(){this.$router.push("/web_login_logs")},caps:function(e){return""==e||null==e?"":e.toString().replace(/\b\w/g,(function(e){return e.toUpperCase()}))},getRecords:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.loading=!0;var o=this.options,r=o.sortBy,c=o.sortDesc,l=o.page,m=(o.itemsPerPage,5);m||(m=5);var d={params:x({page:l,sortBy:r?r[0]:"",sortDesc:c?c[0]:"",per_page:m,filter_column:n,company_id:this.$auth.user.company_id},this.filters)};""!=t&&(d.params[t]=n),this.$axios.get("activity",d).then((function(t){var data=t.data;e.totalRowsCount=data.total,e.logs=data.data,e.loading=!1}))},socketConnection:function(){var e=this;this.socket=new WebSocket(this.url),this.socket.onmessage=function(t){var data=t.data,n=JSON.parse(data);200==n.Status&&n.Data.UserCode>0&&e.getDetails(n.Data)}},getDetails:function(e){var t=this;e.company_id=this.$auth.user.company_id,this.$axios.post("/device/details",e).then((function(e){var data=e.data;data.device&&t.$auth.user&&data.device.company_id==t.$auth.user.company_id&&t.logs.unshift(data)}))},getDataFromApi:function(){var e=this;this.loading=!0;var t=this.options,n={params:{page:t.page,per_page:t.itemsPerPage}};this.$axios.get("device/getLastRecordsHistory/".concat(this.$auth.user.company_id,"/").concat(this.number_of_records),n).then(function(){var t=Object(w.a)(regeneratorRuntime.mark((function t(n){var data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return data=n.data,e.loading=!1,e.total=data.total,t.next=5,data.data.map((function(e){return{UserCode:e.UserID,time:e.time,name:e.employee&&(e.employee.display_name||e.employee.first_name||e.employee.last_name),image:e.employee&&e.employee.profile_picture||"/no-profile-image.jpg"}}));case 5:e.logs=t.sent;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},Object(k.a)(o,"socketConnection",(function(){var e=this;this.socket=new WebSocket(this.url),this.socket.onmessage=function(t){var data=t.data,n=JSON.parse(data).Data;n&&n.UserCode>0&&e.getDetails(n)}})),Object(k.a)(o,"getDetails",(function(e){var t=e.SN,n=e.RecordImage,o=e.UserCode,r=e.RecordDate;if(this.devices&&this.devices.includes(t)){var c=this.employees.find((function(e){return e.system_user_id==o&&null!==e.first_name})),l={UserCode:o,image:"data:image;base64,"+n||!1,time:this.setTime(r),name:c&&(c.display_name||c.first_name||c.last_name)};this.logs.unshift(l)}})),Object(k.a)(o,"setTime",(function(e){var t=new Date(e),n=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0");return"".concat(n,":").concat(o)})),o)},S=j,D=(n(1267),n(60)),component=Object(D.a)(S,(function(){var e=this,t=e._self._c;return t("div",[t(y.a,[t(c.a,{attrs:{md:"10"}},[t("h4",{staticClass:"pl-2"},[e._v("Web Login Activities")])]),e._v(" "),t(c.a,{staticClass:"text-end",attrs:{md:"2"}},[t(h.a,{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,c=n.attrs;return[t(r.a,e._g(e._b({attrs:{"dark-2":"",icon:""}},"v-btn",c,!1),o),[t(m.a,[e._v("mdi-dots-vertical")])],1)]}}])},[e._v(" "),t(f.a,{attrs:{width:"120",dense:""}},[t(v.a,{on:{click:function(t){return e.viewLogs()}}},[t(_.c,{staticStyle:{cursor:"pointer"}},[e._v("\n              View Logs\n            ")])],1)],1)],1)],1)],1),e._v(" "),e.loading?t("ComonPreloader",{attrs:{icon:"face-scan"}}):e._e(),e._v(" "),t(l.a,{attrs:{dense:"",headers:e.headers_table,items:e.logs,loading:e.loading,options:e.options,"footer-props":{itemsPerPageOptions:[5,50]},"server-items-length":e.totalRowsCount,"hide-default-header":""},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.employee.pic",fn:function(e){var n=e.item;e.index;return[t(y.a,{attrs:{"no-gutters":""}},[t(c.a,{staticStyle:{padding:"5px","padding-left":"0px",width:"30px","max-width":"30px"}},[t(d.a,{staticStyle:{"border-radius":"50%",height:"auto",width:"30px","max-width":"30px"},attrs:{src:n.user.employee?n.user.employee.profile_picture:"/no-profile-image.jpg"}})],1)],1)]}},{key:"item.employee.first_name",fn:function(n){var o=n.item;n.index;return[e._v("\n      "+e._s(o.user.employee?o.user.employee.first_name:"Admin")+"\n      "+e._s(o.user.employee?o.user.employee.last_name:" ")+"\n\n      "),t("div",{staticClass:"secondary-value"},[e._v("\n        "+e._s(o.user.employee&&o.user.employee.department?e.caps(o.user.employee.department.name):"---")+"\n      ")])]}},{key:"item.UserID",fn:function(t){var n=t.item;return[e._v(" #"+e._s(n.UserID)+" ")]}},{key:"item.employee.employee_id",fn:function(t){var n=t.item;return[e._v("\n      "+e._s(n.employee&&n.employee.employee_id)+"\n    ")]}},{key:"item.LogTime",fn:function(n){var o=n.item;return[t(m.a,{attrs:{color:"green",fill:""}},[e._v("mdi-clock-outline")]),e._v("\n      "+e._s(o.date_time)+"\n    ")]}},{key:"item.online",fn:function(n){return[n.item.device.location?t(m.a,{attrs:{color:"green",fill:""}},[e._v("mdi-map-marker-radius")]):t(m.a,{attrs:{color:"red",fill:""}},[e._v("mdi-map-marker-radius")])]}},{key:"item.device.device_name",fn:function(n){var o=n.item;return[t("div",{style:o.device.location?"color:green":"color: red;"},[e._v("\n        "+e._s(o.device?e.caps(o.device.name):"---")+" "),t("br"),e._v("\n\n        "+e._s(o.device.location?o.device.location:"---")+"\n      ")])]}}])})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{ComonPreloader:n(925).default})},925:function(e,t,n){"use strict";n.r(t);var o=n(219),r={props:["icon"]},c=n(60),component=Object(c.a)(r,(function(){var e=this._self._c;return e("div",{staticClass:"text-center",staticStyle:{width:"80px",margin:"25% auto"}},[e(o.a,{attrs:{src:"/preloaders/".concat(this.icon,".gif")}})],1)}),[],!1,null,null,null);t.default=component.exports}}]);