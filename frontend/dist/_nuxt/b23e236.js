(window.webpackJsonp=window.webpackJsonp||[]).push([[258,10,33],{905:function(t,e,r){"use strict";r.r(e);var n=r(517),o=(r(56),r(33),r(266),r(952)),l=(r(939),{components:{DatePicker:o.a},props:["defaultFilterType","height","width","default_date_from","default_date_to"],data:function(){return{time3:null,from_date:"",from_menu:!1,to_date:"",to_menu:!1,loading:!1,showTimePanel:!1,filterType:1,search:""}},watch:{filterType:function(){this.showTimePanel=!0,this.FilterData()}},mounted:function(){},created:function(){this.defaultFilterType&&(this.filterType=this.defaultFilterType);var t=new Date;this.from_date=t.toISOString().slice(0,10),this.to_date=t.toISOString().slice(0,10),this.time3=[this.from_date,this.to_date]},methods:{commonMethod:function(){this.from_date&&this.to_date},CustomFilter:function(){if(this.from_date=this.time3[0],this.to_date=this.time3[1],this.from_date&&this.to_date){var data={from:this.from_date,to:this.to_date,type:this.filterType,search:this.search};this.$emit("filter-attr",data)}},FilterData:function(){this.from_date=this.time3[0],this.to_date=this.time3[1];var t=new Date;if(1==this.filterType)this.from_date=t.toISOString().slice(0,10),this.to_date=t.toISOString().slice(0,10);else if(2==this.filterType){var e=new Date;e.setDate(t.getDate()-1),this.from_date=e.toISOString().slice(0,10),this.to_date=e.toISOString().slice(0,10)}else if(3==this.filterType){var r=new Date(t);r.setDate(t.getDate()-t.getDay());var n=new Date(t);n.setDate(t.getDate()-t.getDay()+6),this.from_date=r.toISOString().slice(0,10),this.to_date=n.toISOString().slice(0,10)}else if(4==this.filterType)this.from_date=this.formatDate(new Date(t.getFullYear(),t.getMonth(),1)),this.to_date=this.formatDate(new Date(t.getFullYear(),t.getMonth()+1,0));else if(5==this.filterType)return void(this.time3=[]);if(this.from_date&&this.to_date){var data={from:this.from_date,to:this.to_date,type:this.filterType,search:this.search};this.$emit("filter-attr",data)}},formatDate:function(t){var e=t.getDate(),r=t.getMonth()+1;return t.getFullYear()+"-"+(r<10?"0":"")+r+"-"+(e<10?"0":"")+e}}}),d=(r(950),r(116)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",[e(n.a,[e("date-picker",{staticStyle:{"padding-top":"7px",width:"100%"},attrs:{"value-type":"format",format:"YYYY-MM-DD",type:"date",range:""},on:{change:function(e){return t.CustomFilter()}},model:{value:t.time3,callback:function(e){t.time3=e},expression:"time3"}})],1)],1)}),[],!1,null,null,null);e.default=component.exports},908:function(t,e,r){var content=r(951);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(22).default)("20f2e8f4",content,!0,{sourceMap:!1})},932:function(t,e,r){"use strict";r.r(e);var n=r(114),o=r(133),l=r(87),d=r(518),c=r(875),_=r(1548),v=r(350),m=r(935),f=r(147),h=r(212),y=r(326),D=r(204),x=r(60),k=r(862),O=r(517),S=r(872),w=r(349),j=r(214),I=r(96),C=(r(37),r(12),r(14),r(17),r(11),r(18),r(23)),F=r(3);r(88),r(521),r(35),r(33),r(266),r(56),r(523),r(215),r(80),r(6),r(72),r(58),r(914),r(45),r(915),r(916),r(917),r(918),r(919),r(920),r(921),r(922),r(923),r(924),r(925),r(926),r(927),r(928),r(929),r(930),r(50),r(13),r(55);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function P(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Object(F.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var T={props:["visitorIdentificationNumber","visitorFullName"],components:{Calender:r(905).default},data:function(){var t,e,r,n,o;return t={purposeList:[],branchesList:[],hostList:[],cumulativeIndex:1,perPage:10,currentPage:1,renderVisitorDialog:!1,users:[],formData:{max:10,date:(e=new Date,r=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),"".concat(r,"-").concat(n,"-").concat(o)),company_id:0},attendancFilters:!1,filters:{},isFilter:!1,totalRowsCount:0,datatable_search_textbox:"",datatable_filter_date:"",filter_visitor_id:"",snack:!1,snackColor:"",snackText:"",date:null},Object(F.a)(t,"filter_visitor_id",""),Object(F.a)(t,"generateLogsDialog",!1),Object(F.a)(t,"reportSync",!1),Object(F.a)(t,"isCompany",!0),Object(F.a)(t,"time_table_dialog",!1),Object(F.a)(t,"log_details",!1),Object(F.a)(t,"overtime",!1),Object(F.a)(t,"options",{}),Object(F.a)(t,"date",null),Object(F.a)(t,"menu",!1),Object(F.a)(t,"loading",!1),Object(F.a)(t,"time_menu",!1),Object(F.a)(t,"manual_time_menu",!1),Object(F.a)(t,"Model","Visitor Reports"),Object(F.a)(t,"endpoint","visitor_attendance"),Object(F.a)(t,"search",""),Object(F.a)(t,"snackbar",!1),Object(F.a)(t,"add_manual_log",!1),Object(F.a)(t,"dialog",!1),Object(F.a)(t,"from_date",null),Object(F.a)(t,"from_menu",!1),Object(F.a)(t,"to_date",null),Object(F.a)(t,"to_menu",!1),Object(F.a)(t,"ids",[]),Object(F.a)(t,"visitors",[]),Object(F.a)(t,"DateRange",!0),Object(F.a)(t,"devices",[]),Object(F.a)(t,"valid",!0),Object(F.a)(t,"nameRules",[function(t){return!!t||"reason is required"}]),Object(F.a)(t,"timeRules",[function(t){return!!t||"time is required"}]),Object(F.a)(t,"deviceRules",[function(t){return!!t||"device is required"}]),Object(F.a)(t,"daily_menu",!1),Object(F.a)(t,"daily_date",null),Object(F.a)(t,"dailyDate",!1),Object(F.a)(t,"editItems",{attendance_logs_id:"",UserID:"",device_id:"",user_id:"",reason:"",date:"",time:null}),Object(F.a)(t,"loading",!1),Object(F.a)(t,"total",0),Object(F.a)(t,"log_headers",[{text:"#",align:"left",sortable:!1,filterable:!1,value:"sno"},{text:"Device",align:"left",sortable:!1,filterable:!1,value:"device.name"},{text:"Location",align:"left",sortable:!1,filterable:!1,value:"device.location"},{text:"Time",align:"left",sortable:!1,filterable:!1,value:"time"}]),Object(F.a)(t,"headers",[{text:"#",align:"left",sortable:!1,filterable:!1,value:"sno"},{text:"Date",align:"left",sortable:!1,filterable:!1,filterSpecial:!0,value:"date"},{text:"Host",align:"left",sortable:!1,filterable:!1,filterSpecial:!1,value:"host_id",key:"host_id"},{text:"Purpose",align:"left",sortable:!1,filterable:!0,filterSpecial:!0,value:"purpose_id"},{text:"Check In",align:"left",sortable:!1,filterable:!0,filterSpecial:!1,value:"in"},{text:"Check Out",align:"left",sortable:!1,filterable:!0,filterSpecial:!1,value:"out"},{text:"Duration",align:"left",sortable:!1,filterable:!0,filterSpecial:!1,value:"total_hrs"},{text:"OverStay",align:"left",sortable:!1,filterable:!1,filterSpecial:!0,value:"overstay"},{text:"Options",value:"options",sortable:!1}]),Object(F.a)(t,"frequency","Monthly"),Object(F.a)(t,"payload",{from_date:null,to_date:null,daily_date:null,visitor_id:"",status:"All"}),Object(F.a)(t,"log_payload",{user_id:null,device_id:"",date:null,time:null}),Object(F.a)(t,"log_list",[]),Object(F.a)(t,"snackbar",!1),Object(F.a)(t,"editedIndex",-1),Object(F.a)(t,"editedItem",{name:""}),Object(F.a)(t,"defaultItem",{name:""}),Object(F.a)(t,"response",""),Object(F.a)(t,"data",[]),Object(F.a)(t,"shifts",[]),Object(F.a)(t,"errors",[]),Object(F.a)(t,"custom_options",{}),Object(F.a)(t,"max_date",null),Object(F.a)(t,"item",null),Object(F.a)(t,"viewDialog",!1),Object(F.a)(t,"attendance",[]),t},computed:{formTitle:function(){return-1===this.editedIndex?"New":"Edit"}},watch:{dialog:function(t){t||this.close(),this.errors=[],this.search=""},options:{handler:function(){this.getDataFromApi()},deep:!0}},created:function(){this.loading=!0,this.getVisitors(),this.payload.daily_date=(new Date).toJSON().slice(0,10),this.custom_options={params:{per_page:1e3,company_id:this.$auth.user.company_id}},this.getDeviceList();var dt=new Date,t=dt.getFullYear(),e=dt.getMonth()+1,dd=new Date(dt.getFullYear(),e,0);if(e=e<10?"0"+e:e,this.payload.from_date="".concat(t,"-").concat(e,"-01"),this.payload.to_date="".concat(t,"-").concat(e,"-").concat(dd.getDate()),null==this.$auth.user.branch_id||0==this.$auth.user.branch_id){var r;(r=this.headers).splice.apply(r,[2,0].concat([{text:"Branch",align:"left",sortable:!1,value:"branch_id",filterable:!0,filterName:"branch_id",filterSpecial:!0}]))}},methods:{viewInfo:function(t){this.item=t.visitor,this.attendance=t,this.viewDialog=!0},filterAttr:function(data){this.payload.from_date=data.from,this.payload.to_date=data.to,this.getDataFromApi()},addUser:function(){this.users.push({visitor_id:""})},removeUser:function(t){this.users.splice(t,1)},submitData:function(){var t=this;this.formData.userIds=this.users.map((function(t){return t.visitor_id})),this.formData.company_id=this.$auth.user.company_id,this.$axios.post("/render_daily_report",this.formData).then((function(e){var data=e.data;t.getDataFromApi(),t.snackbar=!0,t.response=data.message,t.dialog=!1})).catch((function(e){var r=e.message;t.snackbar=!0,t.response=r}))},datatable_cancel:function(){this.datatable_search_textbox=""},datatable_open:function(){this.datatable_search_textbox=""},datatable_close:function(){this.loading=!1},processFilterDates:function(){var t=new Date(this.payload.from_date);t.setDate(t.getDate()+("Weekly"==this.frequency?6:30));var e=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();"Custom"!==this.frequency&&(this.payload.to_date="".concat(n,"-").concat(r,"-").concat(e)),this.max_date="".concat(n,"-").concat(r,"-").concat(e),this.getDataFromApi()},set_date_save:function(t,e){t.save(e),this.processFilterDates()},changeReportFrequency:function(){this.processFilterDates()},applyFilters:function(t,e){this.getDataFromApi()},toggleFilter:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isFilter=!t.isFilter,t.isFilter&&(t.refresh=!0,t.handleChangeEvent());case 2:case"end":return e.stop()}}),e)})))()},handleChangeEvent:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("fetchDropDowns",{key:"branchList",endpoint:"branch-list"});case 2:return t.branchesList=e.sent,e.next=5,t.$store.dispatch("fetchDropDowns",{key:"hostList",endpoint:"host_list"});case 5:return t.hostList=e.sent,e.next=8,t.$store.dispatch("fetchDropDowns",{key:"purposeList",endpoint:"purpose_list"});case 8:t.purposeList=e.sent;case 9:case"end":return e.stop()}}),e)})))()},clearFilters:function(){this.filters={},this.isFilter=!1,this.getDataFromApi()},getDeviceList:function(){var t=this,e={params:{company_id:this.$auth.user.company_id}};this.$axios.get("/device_list",e).then((function(e){var data=e.data;t.devices=data}))},store_schedule:function(){var t=this,e=this.log_payload,r={UserID:e.user_id,LogTime:e.date+" "+e.time,DeviceID:e.device_id,company_id:this.$auth.user.company_id};this.loading=!0,this.$axios.post("/generate_log",r).then((function(e){e.data;t.getDataFromApi(),t.add_manual_log=!1,t.loading=!1})).catch((function(e){var r=e.message;t.snackbar=!0,t.response=r}))},setVisitorId:function(t){this.$store.commit("visitor_id",t)},getVisitors:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={params:{company_id:t.$auth.user.company_id}},e.next=3,t.$axios.get("/visitors_with_type",r).then((function(e){var data=e.data;t.visitors=data,t.visitors.unshift({system_user_id:"",name_with_user_id:"Select All"})}));case 3:case"end":return e.stop()}}),e)})))()},caps:function(t){return t.replace(/_/g," ").replace(/\b\w/g,(function(t){return t.toUpperCase()}))},can:function(t){return this.$pagePermission.can(t,this)},getDataFromApi:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.endpoint,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.loading=!0;var o=this.options,l=o.sortBy,d=o.sortDesc,c=o.page,_=o.itemsPerPage,v=l?l[0]:"",m=d?d[0]:"";if("Custom"==this.frequency){if(null==this.payload.from_date)return!1;if(null==this.payload.to_date)return!1}var f={params:P(P(P({page:c,sortBy:v,sortDesc:m,per_page:_,company_id:this.$auth.user.company_id},this.payload),{},{frequency:this.frequency},this.filters),{},{visitorIdentificationNumber:this.visitorIdentificationNumber})};this.currentPage=c,""!=r&&(f.params[r]=n),this.$axios.get(e,f).then(function(){var e=Object(C.a)(regeneratorRuntime.mark((function e(n){var data,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(data=n.data,""==r||0!=data.data.length){e.next=7;break}return t.snack=!0,t.snackColor="error",t.snackText="No Results Found",t.loading=!1,e.abrupt("return",!1);case 7:return t.data=data.data,o=new Set,e.next=11,data.data.filter((function(t){var e=t.visitor_id;return!o.has(e)&&(o.add(e),!0)}));case 11:t.users=e.sent,t.total=data.total,t.loading=!1,t.totalRowsCount=data.total;case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},editItem:function(t){this.dialog=!0,this.editItems.UserID=t.visitor_id,this.editItems.date=t.edit_date},update:function(){var t=this;if(this.$refs.form.validate()){var e={UserID:this.editItems.UserID,LogTime:this.editItems.date+" "+this.editItems.time,DeviceID:this.editItems.device_id,user_id:this.editItems.UserID,company_id:this.$auth.user.company_id,reason:this.editItems.reason};this.$axios.post("/generate_manual_log",e).then((function(e){var data=e.data;t.loading=!1,data.status?(t.snackbar=!0,t.response=data.message,t.close()):t.errors=data.errors})).catch((function(t){return console.log(t)}))}},renderByType:function(t){var e=this,r=this.editItems.UserID,n=this.editItems.date;if(r&&n){var o={params:{date:this.editItems.date,UserID:this.editItems.UserID,updated_by:this.$auth.user.id,company_id:this.$auth.user.company_id,manual_entry:!0,reason:this.editItems.reason}};this.$axios.get("/"+t,o).then((function(t){var data=t.data;e.loading=!1,e.snackbar=!0,e.response=data.message,e.getDataFromApi()})).catch((function(t){return console.log(t)}))}else alert("System User Id and Date field is required")},viewItem:function(t){var e=this;this.log_list=[];var r={params:{per_page:500,UserID:t.system_user_id,LogTime:t.edit_date,company_id:this.$auth.user.company_id}};this.log_details=!0,this.$axios.get("visitor_log_list",r).then((function(t){var data=t.data;e.log_list=data.data}))},close:function(){var t=this;this.dialog=!1,setTimeout((function(){t.editedItem=Object.assign({},t.defaultItem),t.editedIndex=-1}),300)},process_file:function(t){if(this.data.length){var e=this.payload,r=e.visitor_id,n=e.daily_date,o=e.from_date,l=e.to_date,d=e.status,c=this.frequency,_=this.$auth.user.company_id,v=(this.options.itemsPerPage,"");v+="".concat("http://192.168.88.30:8000/api/visitor_attendance_report"),v+="?company_id=".concat(_),v+="&status=".concat(d),v+="&visitor_id=".concat(r),v+="&frequency=".concat(c),v+="&action=".concat(t),v+="&per_page=".concat(20),v+="Daily"==c?"&daily_date=".concat(n):"&from_date=".concat(o,"&to_date=").concat(l);var m=document.createElement("a");m.setAttribute("href",v),m.setAttribute("target","_blank"),m.click(),this.getDataFromApi()}else alert("No record found")}}},U=T,L=r(116),component=Object(L.a)(U,(function(){var t=this,e=t._self._c;return e("div",[e(S.a,{attrs:{top:"top",color:"secondary",elevation:"24"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    "+t._s(t.response)+"\n  ")]),t._v(" "),e(S.a,{attrs:{timeout:3e3,color:t.snackColor},scopedSlots:t._u([{key:"action",fn:function(r){var o=r.attrs;return[e(n.a,t._b({attrs:{text:""},on:{click:function(e){t.snack=!1}}},"v-btn",o,!1),[t._v(" Close ")])]}}]),model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v("\n    "+t._s(t.snackText)+"\n    ")]),t._v(" "),e(O.a,[e(d.a,{staticStyle:{padding:"0px"}},[e(o.a,{staticClass:"mb-5 pa-0",staticStyle:{padding:"0px"},attrs:{elevation:"0"}},[e(_.a,{staticClass:"elevation-1",attrs:{"hide-default-footer":"",dense:"",headers:t.headers,items:t.data,loading:t.loading,options:t.options,"footer-props":{itemsPerPageOptions:[10,50,100,500,1e3]},"model-value":"data.id","server-items-length":t.totalRowsCount},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.sno",fn:function(e){var r=e.item;e.index;return[t._v("\n            "+t._s(t.currentPage?(t.currentPage-1)*t.perPage+(t.cumulativeIndex+t.data.indexOf(r)):"")+"\n          ")]}},{key:"item.visitor_first_name",fn:function(r){var n=r.item;return[e(O.a,{attrs:{"no-gutters":""}},[e(d.a,{staticStyle:{padding:"5px","padding-left":"0px","max-width":"50px"}},[e(h.a,{staticStyle:{"border-radius":"10%",height:"auto",width:"50px","max-width":"50px"},attrs:{src:n.visitor&&n.visitor.logo?n.visitor.logo:"/no-profile-image.jpg"}})],1),t._v(" "),e(d.a,{staticStyle:{padding:"10px"}},[e("strong",[t._v("\n                  "+t._s(n.visitor?n.visitor.first_name:"---")+"\n                  "+t._s(n.visitor?n.visitor.last_name:"---"))]),t._v(" "),e("div",{staticClass:"secondary-value"},[t._v("\n                  "+t._s(n.visitor?n.visitor.phone_number:"---")+"\n                ")]),t._v(" "),e("div",{staticClass:"secondary-value"},[t._v("\n                  "+t._s(n.visitor?n.visitor.email:"---")+"\n                ")])])],1)]}},{key:"item.branch_id",fn:function(e){var r=e.item;return[t._v("\n            "+t._s(r.branch&&r.branch.branch_name)+"\n          ")]}},{key:"item.purpose_id",fn:function(e){var r,n=e.item;return[t._v("\n            "+t._s(n.visitor&&(null===(r=n.visitor.purpose)||void 0===r?void 0:r.name))+"\n          ")]}},{key:"item.in",fn:function(r){var n=r.item;r.index;return[e("div",[t._v("\n              "+t._s(n.in?n.in:"---")+"\n              "),e("div",{staticClass:"secondary-value"},[t._v("\n                "+t._s(n.device_in_name?n.device_in_name.name:"---")+"\n              ")])])]}},{key:"item.out",fn:function(r){var n=r.item;r.index;return[e("div",[t._v("\n              "+t._s(n.out?n.out:"---")+"\n              "),e("div",{staticClass:"secondary-value"},[t._v("\n                "+t._s(n.device_out_name?n.device_out_name.name:"---")+"\n              ")])])]}},{key:"item.overstay",fn:function(r){var n=r.item;r.index;return[e("div",{style:n.over_stay?"color:red":" ;"},[t._v("\n              "+t._s(n.over_stay?n.over_stay:"---")+"\n            ")])]}},{key:"item.host_id",fn:function(r){var n,o,l,d=r.item;r.index;return[e("div",[t._v("\n              "+t._s(d.visitor.host?null===(n=d.visitor.host.employee)||void 0===n?void 0:n.first_name:"---")+"\n              "+t._s(d.visitor.host?null===(o=d.visitor.host.employee)||void 0===o?void 0:o.last_name:"---")+"\n            ")]),t._v(" "),e("div",{staticClass:"secondary-value"},[t._v("\n              "+t._s(d.visitor.host?null===(l=d.visitor.host.employee)||void 0===l?void 0:l.phone_number:"---")+"\n            ")])]}},{key:"item.options",fn:function(r){var o=r.item;return[e(k.a,{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(r){var o=r.on,l=r.attrs;return[e(n.a,t._g(t._b({attrs:{"dark-2":"",icon:""}},"v-btn",l,!1),o),[e(f.a,[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),e(y.a,{attrs:{width:"150",dense:""}},[e(D.a,{on:{click:function(e){return t.viewItem(o)}}},[e(x.c,[e(f.a,{attrs:{small:""}},[t._v(" mdi-history ")]),t._v("\n                    Device Logs\n                  ")],1)],1)],1)],1)]}}])})],1)],1)],1),t._v(" "),e(O.a,{attrs:{justify:"center"}},[e(v.a,{attrs:{persistent:"","max-width":"600px"},model:{value:t.log_details,callback:function(e){t.log_details=e},expression:"log_details"}},[e(o.a,{staticClass:"darken-1"},[e(I.a,{staticClass:"popup_background",attrs:{dense:"",flat:""}},[e("span",{staticClass:"text-h5 pa-2"},[t._v("Log Details")]),t._v(" "),e(w.a),t._v(" "),e(w.a),t._v(" "),e(f.a,{on:{click:function(e){t.log_details=!1}}},[t._v("mdi-close-circle-outline")])],1),t._v(" "),e(l.b,[e("div",{staticClass:"pt-5"},[e(_.a,{staticClass:"elevation-1",attrs:{headers:t.log_headers,items:t.log_list,"hide-default-footer":""},scopedSlots:t._u([{key:"item.sno",fn:function(e){e.item;var r=e.index;return[t._v("\n                "+t._s(++r)+"\n              ")]}}])})],1)])],1)],1),t._v(" "),e(v.a,{attrs:{persistent:"","max-width":"500px"},model:{value:t.renderVisitorDialog,callback:function(e){t.renderVisitorDialog=e},expression:"renderVisitorDialog"}},[e(o.a,[e(l.c,{staticClass:"popup_background"},[e("span",{staticClass:"headline"},[t._v("Submit Data")]),t._v(" "),e(w.a),t._v(" "),e(n.a,{attrs:{"x-small":"",ripple:!1,text:"",title:"Add user"},on:{click:t.addUser}},[e(f.a,{attrs:{dark:""}},[t._v("mdi-plus-circle")])],1)],1),t._v(" "),e(l.b,[e(m.a,{on:{submit:function(e){return e.preventDefault(),t.submitData.apply(null,arguments)}}},[e(c.a,[e(O.a,[e(d.a,{attrs:{cols:"12"}},[e(j.a,{attrs:{label:"Date",required:""},model:{value:t.formData.date,callback:function(e){t.$set(t.formData,"date",e)},expression:"formData.date"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12"}},t._l(t.users,(function(r,i){return e(O.a,{key:i},[e(d.a,{attrs:{cols:"10"}},[e(j.a,{attrs:{label:"User Id",required:""},model:{value:r.visitor_id,callback:function(e){t.$set(r,"visitor_id",e)},expression:"user.visitor_id"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(f.a,{attrs:{color:"error"},on:{click:function(e){return t.removeUser(i)}}},[t._v("mdi-delete")])],1)],1)})),1)],1)],1)],1)],1),t._v(" "),e(l.a,[e(w.a),t._v(" "),e(n.a,{attrs:{small:"",color:"primary"},on:{click:t.submitData}},[t._v("Submit")]),t._v(" "),e(n.a,{attrs:{small:"",color:"gray"},on:{click:function(e){t.renderVisitorDialog=!1}}},[t._v("Cancel")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},950:function(t,e,r){"use strict";r(908)},951:function(t,e,r){var n=r(21)((function(i){return i[1]}));n.push([t.i,".mx-input{border:1px solid #9e9e9e!important;color:#000!important}.mx-datepicker{width:200px}.mx-table-date td,.mx-table-date th{text-align:center!important}",""]),n.locals={},t.exports=n},957:function(t,e,r){"use strict";r.r(e);var n=r(133),o=r(87),l=r(518),d=r(1019),c=r(147),_=r(212),v=r(517),m=r(852),f=r(854),h=r(853),y=r(343),D=(r(37),{props:["item","attendance"],components:{VisitorHistory:r(932).default},data:function(){return{keyid:1}},methods:{getRelatedColor:function(t){return{1:"purple",3:"red",2:"green",UNKNOWN:"purple"}[t.status_id||"UNKNOWN"]},loadHistoryPage:function(){this.keyid++},verifyOverstay:function(t){if(t.attendances&&t.attendances[0]&&t.status_id>=6){var e=t.attendances[0].in,r=t.attendances[0].out,n=0;if(""!=r&&null!=r||(r=this.getCurrentTime()),e&&r&&(n=this.getTimeInSeconds(r)-this.getTimeInSeconds(e))>0)return"Over Stay : "+this.formatSecondsToTime(n)}return""}}}),x=r(116),component=Object(x.a)(D,(function(){var t,e,r,D,x,k,O,S,w=this,j=w._self._c;return j("div",[w.item?j("div",[j(h.a,{staticClass:"slidegroup1",attrs:{right:""}},[j(y.a,{attrs:{color:"violet"}}),w._v(" "),j(m.a,[j("span",[w._v("Information ")])]),w._v(" "),j(m.a,{on:{click:function(t){return w.loadHistoryPage()}}},[j("span",[w._v("History")])]),w._v(" "),j(f.a,[j("span",{staticClass:"bold"},[w._v(" Visitor ")]),w._v(" "),j("span",{staticStyle:{float:"right"}},[j("span",{style:"color:"+w.getRelatedColor(w.item)},[w._v(w._s(w.item.status))])]),w._v(" "),j(v.a,{staticClass:"100%",staticStyle:{margin:"auto","line-height":"36px"}},[j(l.a,{staticStyle:{padding:"0px"},attrs:{cols:"4"}},[j(_.a,{staticStyle:{"border-radius":"50%",width:"250px","max-width":"95%",height:"250px",border:"1px solid #ddd"},attrs:{src:w.item.logo?w.item.logo:"/no-profile-image.jpg"}})],1),w._v(" "),j(l.a,{staticStyle:{"padding-left":"5px","padding-top":"0px"},attrs:{cols:"4"}},[j("span",{attrs:{cols:"8"}},[j("b",[w._v(w._s(w.item.full_name||"---")+" ")])]),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{size:"20",title:"Date"}},[w._v("mdi-calendar-range")]),w._v("\n              "+w._s(w.item.from_date_display)+"\n              "),w.item.to_date_display!=w.item.from_date_display?j("span",[w._v("\n                to "+w._s(w.item.to_date_display))]):w._e()],1),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{size:"20",title:"Time"}},[w._v("mdi-clock-outline")]),w._v("\n              "+w._s(w.item.time_in)+" - "+w._s(w.item.time_out)+"\n            ")],1),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{title:"Purpose",size:"20"}},[w._v("mdi-briefcase-account-outline")]),w._v("\n              "+w._s((null===(t=w.item.purpose)||void 0===t?void 0:t.name)||"---")+"\n            ")],1),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{size:"20",title:"Contact Number"}},[w._v("mdi-cellphone")]),w._v("\n              "+w._s(w.item.phone_number||"---")+"\n            ")],1),w._v(" "),j("div",{staticClass:"bold",staticStyle:{"border-top":"1px solid #ddd"}},[j(c.a,{attrs:{size:"20",color:"green",title:"Entry In Time"}},[w._v("mdi-bank-transfer-in")]),w._v("\n              "+w._s(w.attendance&&w.attendance.in||"---")+" "),j("br"),w._v("\n              "+w._s(w.attendance&&w.attendance.device_in_name.name||"---")+"\n            ")],1),w._v(" "),w.item.over_stay?j("div",{staticStyle:{color:"red"}},[w._v("\n              Expected Out Time: "+w._s(w.item.time_out)+"\n            ")]):w._e()]),w._v(" "),j(l.a,{staticStyle:{"padding-left":"5px","padding-top":"0px"},attrs:{cols:"4"}},[j("div",[w._v("Â ")]),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{title:"Company",size:"30"}},[w._v("mdi-domain")]),w._v("\n              "+w._s(w.item.visitor_company_name||"---")+"\n            ")],1),w._v(" "),j("span",{attrs:{cols:"8"}},["Male"==w.item.gender?j(c.a,{staticClass:"icon-blue",attrs:{size:"20"}},[w._v("mdi-human-male")]):w._e(),w._v(" "),"Female"==w.item.gender?j(c.a,{staticClass:"icon-blue",attrs:{size:"20"}},[w._v("mdi-human-female")]):w._e(),w._v("\n              "+w._s(w.item.gender||"---")+"\n            ")],1),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{size:"20",title:"ID"}},[w._v("mdi-identifier")]),w._v(" "),1==w.item.id_type?j("span",[w._v("Emirates ID")]):2==w.item.id_type?j("span",[w._v("National ID")]):w._e(),w._v("\n\n              : "+w._s(w.item.id_number||"---")+"\n            ")],1),w._v(" "),j("div",[j(c.a,{staticClass:"icon-blue",attrs:{size:"20",title:"Email"}},[w._v("mdi-email")]),w._v("\n              "+w._s(w.item.email||"---")+"\n            ")],1),w._v(" "),j("div",{staticClass:"bold",staticStyle:{"border-top":"1px solid #ddd"}},[j(c.a,{attrs:{size:"30",color:"red",title:"Exit Out Time"}},[w._v("mdi-bank-transfer-out")]),w._v("\n              "+w._s(w.attendance&&w.attendance.out||"---")+"\n              "),j("br"),w._v("\n              "+w._s(w.attendance&&w.attendance.device_out_name.name||"---")+"\n\n              "),j("div",{staticStyle:{color:"red"}},[w._v("\n                Overstay:\n                "+w._s(w.attendance&&w.attendance.over_stay||"---")+"\n\n                ")])],1)])],1),w._v(" "),j(d.a,{staticClass:"mt-3"}),w._v(" "),j("h4",{staticClass:"mb-3",staticStyle:{background:"#ddd"}},[w._v("Host :")]),w._v(" "),j(v.a,[j(l.a,{attrs:{col:"4"}},[j(_.a,{staticStyle:{"border-radius":"50%",width:"200px","max-width":"95%","min-height":"100px",height:"auto",border:"1px solid #ddd"},attrs:{src:w.item.host?w.item.host.employee.profile_picture:"/no-profile-image.jpg"}})],1),w._v(" "),j(l.a,{attrs:{cols:"8"}},[j(v.a,[j(l.a,{attrs:{col:"3"}},[w._v("Employee Name ")]),w._v(" "),j(l.a,{attrs:{col:"9"}},[w._v(": "+w._s(null===(e=w.item.host)||void 0===e?void 0:e.employee.first_name)+"\n                "+w._s(null===(r=w.item.host)||void 0===r?void 0:r.employee.last_name))])],1),w._v(" "),j(v.a,[j(l.a,{attrs:{col:"3"}},[w._v("Contact Number")]),w._v(" "),j(l.a,{attrs:{col:"9"}},[w._v(": "+w._s(null===(D=w.item.host)||void 0===D?void 0:D.employee.phone_number))])],1),w._v(" "),j(v.a,[j(l.a,{attrs:{col:"3"}},[w._v(" Email Id ")]),w._v(" "),j(l.a,{attrs:{col:"9"}},[w._v("\n                "+w._s((null===(x=w.item.host)||void 0===x||null===(k=x.employee.user)||void 0===k?void 0:k.email)||"---")+"\n              ")])],1),w._v(" "),j(v.a,[j(l.a,{attrs:{col:"3"}},[w._v(" Branch ")]),w._v(" "),j(l.a,{attrs:{col:"9"}},[w._v("\n                : "+w._s((null===(O=w.item.host)||void 0===O||null===(S=O.employee.branch)||void 0===S?void 0:S.branch_name)||"---")+"\n              ")])],1),w._v(" "),j(v.a,[j(l.a,{attrs:{col:"3"}},[w._v("Status ")]),w._v(" "),j(l.a,{attrs:{col:"9"}},[j("span",{style:"color:"+w.getRelatedColor(w.item)},[w._v(w._s(w.item.status))])])],1),w._v(" "),j(v.a,[j(l.a,{attrs:{col:"3"}},[w._v("Reason:")]),w._v(" "),j(l.a,{attrs:{col:"9"}},[w._v(" "+w._s(w.item.reason||"---"))])],1)],1)],1)],1),w._v(" "),j(f.a,[j(n.a,{attrs:{flat:""}},[j(o.b,[j("VisitorHistory",{attrs:{visitorIdentificationNumber:w.item.id_number,visitorFullName:w.item.full_name}})],1)],1)],1)],1)],1):w._e()])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{VisitorHistory:r(932).default})},979:function(t,e,r){"use strict";r.r(e);var n=r(893),o=r(114),l=r(133),d=r(87),c=r(518),_=r(875),v=r(1548),m=r(350),f=r(935),h=r(147),y=r(212),D=r(326),x=r(204),k=r(60),O=r(862),S=r(325),w=r(267),j=r(517),I=r(892),C=r(1128),F=r(872),$=r(349),P=r(214),T=r(96),U=r(855),L=r(81),V=(r(35),r(37),r(33),r(58),r(360),r(23)),R=r(3);r(88),r(56),r(215),r(13),r(6),r(11),r(55),r(12),r(14),r(17),r(18);function N(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function A(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?N(Object(source),!0).forEach((function(e){Object(R.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):N(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var z={props:["title","filterValue","isDashboard","statsFilterValue","defaultDates"],components:{Visitorinfo:r(957).default},data:function(){var t;return t={loadingDeviceData:!1,overlay:!1,snackbar:!1,response:"",required:[function(t){return!!t||"Required"}],visitor_status_list:[],uploadUserToDeviceDialog:!1,uploadedUserInfoDialog:!1,valid:!1,fromTimePicker:!1,toTimePicker:!1,payload:{visitor_id:null,zone_id:1,fromTime:null,toTime:null},zoneList:[{id:1,name:"Zone 1"},{id:2,name:"Zone 2"}],hostList:[],item:{purpose:{}},viewDialog:!1,formAction:"Create",previewImage:null,upload:{name:""},isFilter:!1,filters:[],loading:!1,cumulativeIndex:1,perPage:10,currentPage:1,totalRowsCount:0,options:{perPage:10},status_id:0,response_image:"/sucess.png",dialog:!1,message:"",branchesList:[],changeRequestDialog:!1,Model:"Visitor Request",endpoint:"visitor",data:[],from_date:"",to_date:"",headers_table:[{text:"#",align:"left",sortable:!1,value:"sno",filterable:!1},{width:"250px",text:"Picture",align:"left",sortable:!0,value:"phone_number_or_email",filterable:!0},{text:"Purpose",align:"left",sortable:!0,value:"purpose_id",filterable:!0,filterSpecial:!0},{text:"Date",align:"left",sortable:!0,value:"visit_from",filterable:!0,filterSpecial:!0},{text:"From Company",align:"left",sortable:!0,value:"visitor_company_name",filterable:!0,filterSpecial:!1},{text:"Host",align:"left",sortable:!0,value:"host_company_id",filterable:!0,filterSpecial:!0},{text:"Status",align:"left",sortable:!0,value:"status_id",filterable:!0,filterSpecial:!0},{text:"Options",align:"left",sortable:!1,value:"options",filterable:!1}]},Object(R.a)(t,"branchesList",[]),Object(R.a)(t,"branch_id",null),Object(R.a)(t,"pagination",{current:1,total:0,per_page:10}),Object(R.a)(t,"purposeList",[]),Object(R.a)(t,"selectedVisitor",null),Object(R.a)(t,"visitorUploadedDevicesInfo",[]),t},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},created:function(){var t=new Date;if(this.from_date=t.toISOString().slice(0,10),this.to_date=t.toISOString().slice(0,10),this.defaultDates&&this.defaultDates.length&&(this.from_date=this.defaultDates[0],this.to_date=this.defaultDates[1]),this.getDataFromApi(),null==this.$auth.user.branch_id||0==this.$auth.user.branch_id){var e;(e=this.headers_table).splice.apply(e,[2,0].concat([{text:"Branch",align:"left",sortable:!0,value:"branch_id",filterable:!0,filterName:"branch_id",filterSpecial:!0}]))}if("Rejected"==this.statsFilterValue){var r;this.headers_table=this.headers_table.filter((function(t){return"visitor_company_name"!=t.value}));(r=this.headers_table).splice.apply(r,[7,0].concat([{text:"Reason",align:"left",sortable:!0,value:"rejected_reason",filterable:!0,filterSpecial:!0}]))}},methods:{can:function(t){return this.$pagePermission.can(t,this)},deleteFromDevice:function(t){var e=this;if(confirm("Are you sure want to Delete From This Device?")){var r={params:{company_id:this.$auth.user.company_id,visitor_id:t.visitor_id,system_user_id:t.system_user_id,device_id:t.device_id}};this.$axios.post("delete-visitor-from-devices",r.params).then((function(t){var data=t.data;e.response=data.message,e.snackbar=!0,data.status&&(e.uploadedUserInfoDialog=!1)}))}},getbranchesList:function(){var t=this;this.payloadOptions={params:{company_id:this.$auth.user.company_id}},this.$axios.get("branches_list",this.payloadOptions).then((function(e){var data=e.data;t.branchesList=data}))},verifyOverstay:function(t){if(t.attendances&&t.attendances[0]&&t.status_id>=6){var e=t.attendances[0].in,r=t.attendances[0].out,n=0;if(""!=r&&null!=r||(r=this.getCurrentTime()),e&&r&&(n=this.getTimeInSeconds(r)-this.getTimeInSeconds(e))>0)return"Over Stay : "+this.formatSecondsToTime(n)}return""},formatSecondsToTime:function(t){return Math.floor(t/3600)+"h:"+Math.floor(t%3600/60)+"m"},getTimeInSeconds:function(time){var t=time.split(":");return 3600*parseInt(t[0],10)+60*parseInt(t[1],10)+parseInt(t[2],10)},getCurrentTime:function(){var t=new Date;return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},viewUploadedVisitorInfo:function(t){var e=this;return Object(V.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.uploadedUserInfoDialog=!0,e.visitorUploadedDevicesInfo=[],e.loadingDeviceData=!0,n=1,r.next=6,t.zone.devices.forEach((function(element){var r={params:{company_id:e.$auth.user.company_id,visitor_id:t.id,system_user_id:t.system_user_id,zone_id:t.zone_id,device_id:element.device_id}};e.loadingDeviceData=!0,e.$axios.get("get-device-person-details",r).then((function(r){var data=r.data;return t.zone.devices.length==n&&(e.loadingDeviceData=!1),n++,data.deviceName?(data.system_user_id=t.system_user_id,data.device_id=element.device_id,data.visitor_id=t.id,void e.visitorUploadedDevicesInfo.push(data)):(e.response=data.message,void(e.snackbar=!0))}))}));case 6:case"end":return r.stop()}}),r)})))()},uploadVisitorInfo:function(t){this.response="",this.selectedVisitor=t,this.uploadUserToDeviceDialog=!0,this.payload.system_user_id=t.system_user_id,this.payload.zone_id=t.zone_id,this.payload.card_rfid_number=t.card_rfid_number,this.payload.card_rfid_password=t.card_rfid_password},cancel:function(){this.uploadUserToDeviceDialog=!1},save:function(){var t=this;if(this.$refs.form.validate()){var e={params:{company_id:this.$auth.user.company_id,visitor_id:this.selectedVisitor.id,system_user_id:this.payload.system_user_id,zone_id:this.payload.zone_id,card_rfid_number:this.payload.card_rfid_number,card_rfid_password:this.payload.card_rfid_password}};this.response="Visitor Profile picture is uploading to Device. Please wait for 5 to 10 seconds",this.snackbar=!0,this.valid=!1,this.overlay=!0,this.$axios.post("visitor-update-zone",e.params).then((function(e){var data=e.data;return t.loading=!1,t.valid=!1,data.status?void setTimeout((function(){t.overlay=!1,t.valid=!0,t.uploadUserToDeviceDialog=!1,t.response="Visitor Zone details are updated successfully",t.snackbar=!0,t.getDataFromApi()}),2e3):(t.response=data.message,t.snackbar=!0,t.overlay=!1,void(t.valid=!0))}))}},viewInfo:function(t){this.viewDialog=!0,this.item=t},filterAttr:function(data){null!=data?(this.from_date=data.from,this.to_date=data.to):(this.from_date=null,this.to_date=null),this.applyFilters()},applyFilters:function(){this.getDataFromApi(),this.$emit("changeBranch",this.filters.branch_id)},toggleFilter:function(){this.isFilter=!this.isFilter,this.isFilter&&(this.getPurposeList(),this.getHostsList(),this.getbranchesList(),this.getVisitorStatusList())},getPurposeList:function(){var t=this,e={params:{company_id:this.$auth.user.company_id}};this.$axios.get("purpose_list",e).then((function(e){var data=e.data;t.purposeList=data}))},getHostsList:function(){var t=this,e={params:{company_id:this.$auth.user.company_id}};this.$axios.get("host_list",e).then((function(e){var data=e.data;t.hostList=[];for(var i=0;i<data.length;i++){var r=data[i],n=r.employee;n&&t.hostList.push({host_id:r.id,full_name:n.full_name})}}))},getVisitorStatusList:function(){var t=this,e={params:{company_id:this.$auth.user.company_id}};this.$axios.get("visitor_status_list",e).then((function(e){var data=e.data;t.visitor_status_list=data}))},updateStatus:function(t,e){var r=this;this.status_id=e,this.$axios.post("visitor-status-update/".concat(t),{status_id:e}).then((function(t){var data=t.data;if(!data.status)return r.message=data.message,r.response_image="/fail.png",void setTimeout((function(){return r.dialog=!1}),3e3);r.message="Your clocking has been recorded successfully",r.response_image=1==e?"/success.png":"/fail.png",r.dialog=!0,r.message=data.message,r.getDataFromApi()}))},getRelatedColor:function(t){return{1:"purple",3:"red",2:"green",UNKNOWN:"purple"}[t.status_id||"UNKNOWN"]},getDataFromApi:function(){var t=this;this.loading=!0;var e=this.options,r=e.sortBy,n=e.sortDesc,o=e.page,l=e.itemsPerPage,d={params:A(A({page:o,sortBy:r?r[0]:"",sortDesc:n?n[0]:"",per_page:l,pagination:!0,company_id:this.$auth.user.company_id,from_date:this.from_date,to_date:this.to_date},this.filters),{},{statsFilterValue:this.statsFilterValue})};this.currentPage=o,this.perPage=l,this.$axios.get(this.endpoint,d).then((function(e){var data=e.data;t.data=data.data,t.pagination.current=data.current_page,t.pagination.total=data.last_page,t.loading=!1,t.totalRowsCount=data.total}))}}},E=r(116),component=Object(E.a)(z,(function(){var t=this,e=t._self._c;return e("div",[e(F.a,{attrs:{top:"top",color:"secondary",elevation:"24"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    "+t._s(t.response)+"\n  ")]),t._v(" "),e(S.a,{attrs:{value:t.overlay}},[e(w.a,{attrs:{indeterminate:"",size:"64"}})],1),t._v(" "),e(m.a,{attrs:{width:"1400"},model:{value:t.viewDialog,callback:function(e){t.viewDialog=e},expression:"viewDialog"}},[e(l.a,[e(d.c,{staticClass:"popup_background",attrs:{dense:""}},[t._v("\n        Visitor Information - "+t._s(t.item&&t.item.full_name)+"\n        "),e($.a),t._v(" "),e(h.a,{attrs:{outlined:"",dark:""},on:{click:function(e){t.viewDialog=!1}}},[t._v("\n          mdi mdi-close-circle\n        ")])],1),t._v(" "),e(d.b,[e("Visitorinfo",{key:t.item&&t.item.id,attrs:{item:t.item}})],1)],1)],1),t._v(" "),e(l.a,{staticClass:"mt-2",staticStyle:{"min-height":"500px"},attrs:{elevation:"1"}},[t.isDashboard?t._e():e(T.a,{staticClass:"mb-2 popup_background",attrs:{dense:"",flat:""}},[e(U.b,[e("span",{staticClass:"page-title-display",staticStyle:{color:"black"}},[t._v("\n          "+t._s(t.title))])]),t._v(" "),e("span",[e(o.a,{staticClass:"ma-0 px-0",attrs:{title:"Reload",dense:"","x-small":"",ripple:!1,text:""},on:{click:function(e){return t.getDataFromApi()}}},[e(h.a,{staticClass:"ml-2",attrs:{dark:""}},[t._v("mdi mdi-reload")])],1)],1),t._v(" "),e("span",[e(o.a,{staticClass:"ma-0 px-0",attrs:{dense:"","x-small":"",ripple:!1,text:"",title:"Filter"}},[e(h.a,{staticClass:"mx-1 ml-2",on:{click:t.toggleFilter}},[t._v("mdi mdi-filter")])],1)],1),t._v(" "),e($.a)],1),t._v(" "),e(v.a,{staticClass:"elevation-0 alternate-rows",attrs:{dense:"",headers:t.headers_table,items:t.data,"model-value":"data.id",loading:t.loading,options:t.options,"footer-props":{itemsPerPageOptions:[10,50,100,500,1e3]},"server-items-length":t.totalRowsCount,"hide-default-footer":t.isDashboard},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"header",fn:function(r){var o=r.props.headers;return[t.isFilter&&!t.isDashboard?e("tr",t._l(o,(function(header){return e("td",{key:header.text},[e(_.a,[header.filterable&&!header.filterSpecial?e(P.a,{attrs:{clearable:"","hide-details":!0,id:"header.value",outlined:"",dense:"",autocomplete:"off"},on:{input:function(e){return t.applyFilters(header.value,e)}},model:{value:t.filters[header.value],callback:function(e){t.$set(t.filters,header.value,e)},expression:"filters[header.value]"}}):header.filterable&&header.filterSpecial&&"status_id"==header.value?e(I.a,{attrs:{clearable:"","hide-details":!0,"item-value":"id","item-text":"name",outlined:"",dense:"",items:[{id:"",name:"All"}].concat(Object(L.a)(t.visitor_status_list))},on:{change:function(e){return t.applyFilters("status",e)}},model:{value:t.filters[header.value],callback:function(e){t.$set(t.filters,header.value,e)},expression:"filters[header.value]"}}):header.filterable&&header.filterSpecial&&"purpose_id"==header.value?e(I.a,{attrs:{clearable:"","hide-details":!0,"item-value":"id","item-text":"name",outlined:"",dense:"",items:[{id:"",name:"All Purposes"}].concat(Object(L.a)(t.purposeList))},on:{change:function(e){return t.applyFilters("status",e)}},model:{value:t.filters[header.value],callback:function(e){t.$set(t.filters,header.value,e)},expression:"filters[header.value]"}}):t._e(),t._v(" "),header.filterSpecial&&"branch_id"==header.value?e(I.a,{attrs:{"hide-details":!0,clearable:"","item-value":"id","item-text":"branch_name",outlined:"",dense:"",items:[{branch_name:"All Branches",id:""}].concat(Object(L.a)(t.branchesList))},on:{change:function(e){return t.applyFilters("status",e)}},model:{value:t.filters[header.value],callback:function(e){t.$set(t.filters,header.value,e)},expression:"filters[header.value]"}}):header.filterable&&header.filterSpecial&&"host_company_id"==header.value?e(n.a,{attrs:{clearable:"","hide-details":!0,"item-value":"host_id","item-text":"full_name",outlined:"",dense:"",items:[{host_id:"",full_name:"All Hosts"}].concat(Object(L.a)(t.hostList))},on:{change:function(e){return t.applyFilters("status",e)}},model:{value:t.filters[header.value],callback:function(e){t.$set(t.filters,header.value,e)},expression:"filters[header.value]"}}):header.filterable&&header.filterSpecial&&"visit_from"==header.value?e("div",{staticStyle:{"margin-top":"-17px"}},[e("Calender",{attrs:{defaultFilterType:1,height:"40px",default_date_from:t.from_date,default_date_to:t.to_date},on:{"filter-attr":t.filterAttr}})],1):t._e()],1)],1)})),0):t._e()]}},{key:"item.sno",fn:function(e){var r=e.item;e.index;return[t._v("\n        "+t._s(t.currentPage?(t.currentPage-1)*t.perPage+(t.cumulativeIndex+t.data.indexOf(r)):"-")+"\n      ")]}},{key:"item.phone_number_or_email",fn:function(r){var n=r.item;return[e(j.a,{attrs:{"no-gutters":""}},[e(c.a,{staticStyle:{padding:"5px","padding-left":"0px",width:"50px","max-width":"50px"}},[e(y.a,{staticStyle:{border:"1px solid #ddd","border-radius":"50%",height:"50px",width:"50px","max-width":"50px"},attrs:{src:n.logo?n.logo:"/no-profile-image.jpg"}})],1),t._v(" "),e(c.a,{staticStyle:{padding:"10px"}},[e("strong",[t._v("\n              "+t._s(n?n.first_name:"---")+"\n              "+t._s(n?n.last_name:"---"))]),t._v(" "),e("div",{staticClass:"secondary-value"},[t._v("\n              "+t._s(n?n.phone_number:"---")+"\n            ")]),t._v(" "),e("div",{staticClass:"secondary-value"},[t._v("\n              "+t._s(n?n.email:"---")+"\n            ")])])],1)]}},{key:"item.first_name",fn:function(e){var r=e.item;return[t._v("\n        "+t._s(r.full_name)+"\n      ")]}},{key:"item.branch_id",fn:function(r){var n=r.item;return[t._v("\n        "+t._s(n.branch&&n.branch.branch_name||"---")+"\n\n        "),e("div",{staticClass:"secondary-value"},[t._v("\n          "+t._s(n.host&&n.host.floor_number||"---")+" -\n          "+t._s(n.host&&n.host.flat_number||"---")+" -\n        ")])]}},{key:"item.purpose_id",fn:function(e){var r,n=e.item;return[t._v("\n        "+t._s(null===(r=n.purpose)||void 0===r?void 0:r.name)+"\n      ")]}},{key:"item.visit_from",fn:function(r){var n=r.item;return[t._v("\n        "+t._s(t.$dateFormat.format1(n.from_date_display))+"\n        "),n.to_date_display!=n.from_date_display?e("div",[t._v("\n          to "+t._s(t.$dateFormat.format1(n.to_date_display))+"\n        ")]):t._e(),t._v(" "),e("div",{staticClass:"secondary-value"},[t._v("\n          "+t._s(t.$dateFormat.time2Hm(n.time_in))+" -\n          "+t._s(t.$dateFormat.time2Hm(n.time_out))+"\n        ")])]}},{key:"item.visitor_company_name",fn:function(e){var r=e.item;return[t._v(t._s(r.visitor_company_name)+"\n      ")]}},{key:"item.id",fn:function(r){var n=r.item;return[1==n.id_type?e("span",[t._v("Emirates ID")]):2==n.id_type?e("span",[t._v("National ID")]):t._e(),t._v(" "),e("br"),t._v(" "),e("span",{staticClass:"secondary-value"},[t._v(" "+t._s(n.id_number))])]}},{key:"item.host_company_id",fn:function(e){var r,n,o=e.item;return[t._v("\n        "+t._s((null===(r=o.host)||void 0===r?void 0:r.employee.first_name)||"---")+"\n        "+t._s(null===(n=o.host)||void 0===n?void 0:n.employee.last_name)+"\n      ")]}},{key:"item.rejected_reason",fn:function(r){var n=r.item;return[e("div",{staticStyle:{color:"red"}},[t._v("\n          "+t._s(n.rejected_reason)+"\n        ")])]}},{key:"item.status_id",fn:function(r){var n=r.item;return[e("span",{style:"color:"+t.getRelatedColor(n)},[t._v(t._s(n.status)+"\n          "),e("div",{staticStyle:{color:"red"}},[t._v("\n            "+t._s(t.verifyOverstay(n))+"\n          ")]),t._v(" "),n.status_id>=4?e("div",{staticClass:"secondary-value"},[t._v("\n            "+t._s(n.system_user_id)+"\n          ")]):t._e()])]}},{key:"item.options",fn:function(r){var n=r.item;return[e(O.a,{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on,l=r.attrs;return[e(o.a,t._g(t._b({attrs:{"dark-2":"",icon:""}},"v-btn",l,!1),n),[e(h.a,[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),e(D.a,{attrs:{width:"150",dense:""}},[e(x.a,{on:{click:function(e){return t.viewInfo(n)}}},[e(k.c,{staticStyle:{cursor:"pointer"}},[e(h.a,{attrs:{color:"green",small:""}},[t._v(" mdi-eye ")]),t._v("\n                View\n              ")],1)],1),t._v(" "),t.can("host_edit")?e(x.a,{on:{click:function(e){return t.uploadVisitorInfo(n)}}},[e(k.c,{staticStyle:{cursor:"pointer"}},[e(h.a,{attrs:{color:"purple",small:""}},[t._v(" mdi-cellphone-text ")]),t._v("\n                Upload Visitor to Device\n              ")],1)],1):t._e(),t._v(" "),n.system_user_id>0?e(x.a,{on:{click:function(e){return t.viewUploadedVisitorInfo(n)}}},[e(k.c,{staticStyle:{cursor:"pointer"}},[e(h.a,{attrs:{color:"purple",small:""}},[t._v(" mdi-eye ")]),t._v("\n                View Uploded info\n              ")],1)],1):t._e()],1)],1)]}}])})],1),t._v(" "),e("div",{staticClass:"text-center"},[e(m.a,{attrs:{"max-width":"500px"},model:{value:t.uploadUserToDeviceDialog,callback:function(e){t.uploadUserToDeviceDialog=e},expression:"uploadUserToDeviceDialog"}},[e(l.a,[e(d.c,{staticClass:"headline"},[t._v("Upload Visitor")]),t._v(" "),e(d.b,{staticClass:"mt-2"},[e(f.a,{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e(P.a,{attrs:{label:"Visitor ID",required:"",outlined:"",dense:"",type:"number",rules:t.required},model:{value:t.payload.system_user_id,callback:function(e){t.$set(t.payload,"system_user_id",e)},expression:"payload.system_user_id"}}),t._v(" "),e(P.a,{attrs:{label:"RFID Card Number",required:"",outlined:"",dense:"",type:"number"},model:{value:t.payload.card_rfid_number,callback:function(e){t.$set(t.payload,"card_rfid_number",e)},expression:"payload.card_rfid_number"}}),t._v(" "),e(P.a,{attrs:{label:"Password",required:"",outlined:"",dense:"",type:"number"},model:{value:t.payload.card_rfid_password,callback:function(e){t.$set(t.payload,"card_rfid_password",e)},expression:"payload.card_rfid_password"}}),t._v(" "),e(I.a,{attrs:{items:t.zoneList,label:"Zone Devices","item-text":"name","item-value":"id",outlined:"",dense:"",required:"",rules:t.required},model:{value:t.payload.zone_id,callback:function(e){t.$set(t.payload,"zone_id",e)},expression:"payload.zone_id"}})],1)],1),t._v(" "),e("div",{staticClass:"pa-5",staticStyle:{"font-size":"14px"}},[t._v("\n          "+t._s(t.response)+"\n        ")]),t._v(" "),e(d.a,[e($.a),t._v(" "),e(o.a,{attrs:{dark:"",color:"grey"},on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),e(o.a,{attrs:{dark:"",color:"purple",disabled:!t.valid},on:{click:t.save}},[t._v("Save")])],1)],1)],1),t._v(" "),e(m.a,{attrs:{width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(l.a,[e(T.a,{attrs:{flat:"",dense:""}},[e($.a),t._v(" "),e(h.a,{on:{click:function(e){t.dialog=!1}}},[t._v("mdi-close")])],1),t._v(" "),e(d.b,[e("p",{staticClass:"text-center"},[e(y.a,{staticStyle:{display:"inline-block"},attrs:{src:t.response_image,alt:"Avatar",height:"50px",width:"50px"}})],1),t._v(" "),e("p",{staticClass:"text-center"},[t._v("\n            "+t._s(t.message)+"\n          ")])])],1)],1),t._v(" "),e(m.a,{attrs:{"max-width":"500px"},model:{value:t.uploadedUserInfoDialog,callback:function(e){t.uploadedUserInfoDialog=e},expression:"uploadedUserInfoDialog"}},[e(l.a,{attrs:{loading:t.loadingDeviceData}},[e(d.a,[e("span",[t._v("Reading Visitor info from Devices")]),t._v(" "),e($.a),t._v(" "),e(h.a,{attrs:{outlined:""},on:{click:function(e){t.uploadedUserInfoDialog=!1}}},[t._v("mdi-close-circle-outline")])],1),t._v(" "),e(d.b,{staticClass:"mt-2"},t._l(t.visitorUploadedDevicesInfo,(function(r,n){return e(l.a,{key:"vs"+n},[e(d.c,{staticStyle:{"font-size":"13px"}},[t._v(t._s(++n)+": Device: "+t._s(r.deviceName)+"\n            ")]),t._v(" "),e(d.b,{staticClass:"mt-2"},[r.SDKresponseData.data?e(j.a,{staticClass:"100%",staticStyle:{margin:"auto","line-height":"36px"}},[e(c.a,{staticStyle:{padding:"0px"},attrs:{cols:"4"}},[e(y.a,{staticStyle:{"border-radius":"10%",width:"100px","max-width":"95%",height:"auto",border:"1px solid #ddd"},attrs:{src:r.SDKresponseData.data.faceImage?"data:image/jpeg;base64, "+r.SDKresponseData.data.faceImage:"/no-profile-image.jpg"}})],1),t._v(" "),e(c.a,{staticStyle:{padding:"0px"},attrs:{cols:"8"}},[e(C.a,[e("tr",[e("td",[t._v("Name")]),t._v(" "),e("td",[t._v(": "+t._s(r.SDKresponseData.data.name))])]),t._v(" "),e("tr",[e("td",[t._v("System User Id")]),t._v(" "),e("td",[t._v(": "+t._s(r.SDKresponseData.data.userCode))])]),t._v(" "),e("tr",[e("td",[t._v("Expiry Date")]),t._v(" "),e("td",[t._v(": "+t._s(r.SDKresponseData.data.expiry))])]),t._v(" "),e("tr",[e("td",[t._v("RFID Card Number")]),t._v(" "),e("td",[t._v(": "+t._s(r.SDKresponseData.data.cardData))])]),t._v(" "),e("tr",[e("td",[t._v("Password")]),t._v(" "),e("td",[t._v("\n                        :\n                        "+t._s(r.SDKresponseData.data.password.replaceAll("F",""))+"\n                      ")])]),t._v(" "),e("tr",[e("td",[t._v("Timezone Group Id")]),t._v(" "),e("td",[t._v(": "+t._s(r.SDKresponseData.data.timeGroup))])])])],1)],1):e("div",[t._v(t._s(r.SDKresponseData.message))]),t._v(" "),e(j.a,[e(c.a,{attrs:{cols:"12"}},[t.can("visitor_delete")?e(o.a,{staticClass:"align-right",staticStyle:{float:"right",color:"#fff"},attrs:{dense:"",small:"",color:"red"},on:{click:function(e){return t.deleteFromDevice(r)}}},[t._v("Delete")]):t._e()],1)],1)],1)],1)})),1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Calender:r(905).default})}}]);