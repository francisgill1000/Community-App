(window.webpackJsonp=window.webpackJsonp||[]).push([[174,180],{1744:function(e,t,n){"use strict";n.r(t);var r=n(114),o=n(133),c=n(87),l=n(516),d=n(876),m=n(1563),_=n(350),v=n(147),h=n(326),f=n(204),y=n(60),k=n(863),x=n(515),I=n(893),w=n(873),C=n(349),T=n(214),$=n(96),A=n(856),D=n(81),L=(n(37),n(35),n(23)),S=(n(88),n(215),n(6),n(11),n(13),n(55),n(216),n(33),n(266),n(361)),O={components:{TiptapVuetify:S.p},data:function(){return{dialogEdit:!1,attrs:{},leaveTypes:[],designations:[],formTitle:"New Leave Group",dialogEmployees:!1,idsEmployeeList:[],datatable_search_textbox:"",filter_employeeid:"",snack:!1,snackColor:"",snackText:"",extensions:[S.g,S.a,S.k,S.i,S.r,S.o,S.j,S.l,S.c,S.m,[S.f,{options:{levels:[1,2,3]}}],S.b,S.k,S.d,S.h,S.n,S.e],content:"\n      <h1>Yay Headlines!</h1>\n      <p>All these <strong>cool tags</strong> are working now.</p>\n        ",scrollInvoked:0,start_menu:!1,end_menu:!1,title:"",des:"",desDate:"",dept:"",options:{},Model:"Leaves Group",endpoint:"leave_groups",search:"",snackbar:!1,dialog:!1,ids:[],departments:[],loading:!1,total:0,headers:[{text:"Group Name",align:"left",sortable:!0,value:"group_name"},{text:"Leave Types",align:"left",sortable:!0,key:"name",value:"leave_count"},{text:"Actions",align:"center",value:"action",sortable:!1}],editedIndex:-1,editedItem:{group_name:""},defaultItem:{group_name:""},response:"",data:[],errors:[],options_dialog:{},employees_dialog:[],selectAllDepartment:!1,selectAllEmployee:!1,DialogEmployeesData:{},branchesList:[],branch_id:"",isCompany:!0}},computed:{},watch:{},created:function(){var e=this;return Object(L.a)(regeneratorRuntime.mark((function t(){var n,r,o,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,!e.$auth.user.branch_id){t.next=5;break}return e.branch_id=e.$auth.user.branch_id,e.isCompany=!1,t.abrupt("return");case 5:return r=[{text:"Branch",align:"left",sortable:!0,key:"branch_id",value:"branch.branch_name",width:"300px",filterable:!0,filterSpecial:!0}],(n=e.headers).splice.apply(n,[0,0].concat(r)),t.prev=7,t.next=10,e.$axios.get("branches_list",{params:{per_page:100,company_id:e.$auth.user.company_id}});case 10:o=t.sent,data=o.data,e.branchesList=data,t.next=18;break;case 15:t.prev=15,t.t0=t.catch(7),console.error("Error fetching branch list",t.t0);case 18:e.getDataFromApi();case 19:case"end":return t.stop()}}),t,null,[[7,15]])})))()},methods:{can:function(e){return this.$pagePermission.can(e,this)},getLeaveTypes:function(){var e=this;return Object(L.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("this.editedItem ",e.editedItem),n={params:{per_page:1e3,company_id:e.$auth.user.company_id,branch_id:e.editedItem.branch_id}},t.next=4,e.$axios.get("leave_type",n).then((function(t){var data=t.data;e.leaveTypes=data.data}));case 4:case"end":return t.stop()}}),t)})))()},getDataFromApi:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.endpoint,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";""==t&&(t=this.endpoint),this.loading=!0;var o=new Date,c=this.options,l=c.page,d={params:{per_page:c.itemsPerPage,company_id:this.$auth.user.company_id,branch_id:this.branch_id,year:o.getFullYear()}};""!=n&&(d.params[n]=r),this.$axios.get("".concat(t,"?page=").concat(l),d).then((function(t){var data=t.data;if(""!=n&&0==data.data.length)return e.snack=!0,e.snackColor="error",e.snackText="No Results Found",e.loading=!1,!1;e.data=data.data,e.total=data.total,e.loading=!1}))},createNew:function(){var e=this;return Object(L.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.getLeaveTypes(),e.isCompany||(e.editedItem.branch_id=e.branch_id),e.leaveTypes.forEach((function(element){element.leave_type_count=""})),e.dialog=!0,e.error=[];case 5:case"end":return t.stop()}}),t)})))()},editItem:function(e){var t=this;return Object(L.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.formTitle="Edit Group Details",t.editedIndex=t.data.indexOf(e),t.editedItem=Object.assign({},e),t.editedItem.branch_id=e.branch_id,n.next=6,t.getLeaveTypes();case 6:t.leaveTypes.forEach((function(element){element.leave_type_count=t.editedItem.leave_count.filter((function(e){return e.leave_type_id==element.id})),element.leave_type_count[0]&&(element.leave_type_count=element.leave_type_count[0].leave_type_count)})),t.dialog=!0,t.error=[];case 9:case"end":return n.stop()}}),n)})))()},viewItem:function(e){this.$router.push("/leavecount/"+e.id)},deleteItem:function(e){var t=this;confirm("Are you sure you wish to delete , to mitigate any inconvenience in future.")&&this.$axios.delete(this.endpoint+"/"+e.id).then((function(e){var data=e.data;data.status?(t.getDataFromApi(),t.snackbar=data.status,t.response=data.message):t.errors=data.errors})).catch((function(e){return console.log(e)}))},close:function(){var e=this;this.dialog=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},save:function(){var e=this,t={params:{branch_id:this.editedItem.branch_id,company_id:this.$auth.user.company_id,group_name:this.editedItem.group_name,leave_counts:this.leaveTypes}};if(this.editedItem.company_id=this.$auth.user.company_id,this.editedIndex>-1)this.$axios.put(this.endpoint+"/"+this.editedItem.id,t.params).then((function(t){var data=t.data;if(data.status){e.data.findIndex((function(t){return t.id==e.editedItem.id}));e.getDataFromApi(),e.snackbar=data.status,e.response=data.message,e.close()}else e.errors=data.errors,e.errors=data.errors,e.snackColor="error",e.snackbar=!0,e.response=data.message})).catch((function(e){return console.log(e)}));else{var n={params:{branch_id:this.editedItem.branch_id,company_id:this.$auth.user.company_id,group_name:this.editedItem.group_name,leave_counts:this.leaveTypes}};this.$axios.post(this.endpoint,n.params).then((function(t){var data=t.data;data.status?(e.getDataFromApi(),e.snackbar=data.status,e.response=data.message,e.close(),e.errors=[],e.search=""):(e.errors=data.errors,e.response=data.message,e.search="")})).catch((function(e){return console.log(e)}))}}}},j=O,E=n(116),component=Object(E.a)(j,(function(){var e=this,t=e._self._c;return e.can("leave_group_access")?t("div",[t("div",{staticClass:"text-center ma-2"},[t(w.a,{attrs:{top:"top",color:e.snackColor,elevation:"24"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n      "+e._s(e.response)+"\n    ")])],1),e._v(" "),t(_.a,{attrs:{width:"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(o.a,[t(c.c,{staticClass:"popup_background",attrs:{dense:""}},[t("span",[e._v(e._s(e.formTitle)+" ")]),e._v(" "),t(C.a),e._v(" "),t(v.a,{attrs:{outlined:"",dark:""},on:{click:function(t){e.dialog=!1}}},[e._v("\n          mdi mdi-close-circle\n        ")])],1),e._v(" "),t(c.b,[t(d.a,[t(x.a,[e.isCompany?t(l.a,{attrs:{cols:"12"}},[t("label",{staticStyle:{"margin-bottom":"5px"},attrs:{for:""}},[e._v("Branches")]),e._v(" "),t(I.a,{attrs:{items:e.branchesList,dense:"",placeholder:"Select Branch",outlined:"","item-value":"id","item-text":"branch_name","error-messages":e.errors&&e.errors.branch_id?e.errors.branch_id[0]:""},model:{value:e.editedItem.branch_id,callback:function(t){e.$set(e.editedItem,"branch_id",t)},expression:"editedItem.branch_id"}})],1):e._e(),e._v(" "),t(l.a,{attrs:{cols:"12"}},[t("label",{staticStyle:{"margin-bottom":"5px"},attrs:{for:""}},[e._v("Group Name")]),e._v(" "),t(T.a,e._b({attrs:{outlined:"",dense:"","error-messages":e.errors&&e.errors.group_name?e.errors.group_name[0]:""},model:{value:e.editedItem.group_name,callback:function(t){e.$set(e.editedItem,"group_name",t)},expression:"editedItem.group_name"}},"v-text-field",e.attrs,!1))],1)],1),e._v(" "),e._l(e.leaveTypes,(function(n,r){return t(x.a,{key:r},[t(l.a,{attrs:{cols:"6"}},[e._v("\n              "+e._s(n.name)+"\n            ")]),e._v(" "),t(l.a,{attrs:{cols:"6"}},[t(T.a,e._b({attrs:{type:"number",outlined:"",dense:""},model:{value:n.leave_type_count,callback:function(t){e.$set(n,"leave_type_count",t)},expression:"item.leave_type_count"}},"v-text-field",e.attrs,!1))],1)],1)}))],2)],1),e._v(" "),t(c.a,[t(C.a),e._v(" "),t(r.a,{staticClass:"primary",attrs:{small:""},on:{click:e.save}},[e._v("Save")])],1)],1)],1),e._v(" "),t(x.a,[t(l.a,{attrs:{md:"12"}},[t(o.a,{staticClass:"mb-5 mt-2 rounded-md",attrs:{elevation:"0"}},[t($.a,{staticClass:"rounded-md",attrs:{dense:"",flat:""}},[t(A.b,[t("span",[e._v(" Leave Groups List")])]),e._v(" "),t(r.a,{staticClass:"ma-0 px-0",attrs:{dense:"","x-small":"",ripple:!1,text:"",title:"Reload"}},[t(v.a,{staticClass:"ml-2",attrs:{dark:""},on:{click:function(t){return e.getDataFromApi()}}},[e._v("mdi mdi-reload")])],1),e._v(" "),e.isCompany?t("div",{staticStyle:{width:"250px"}},[t(I.a,{staticClass:"pt-10 px-2",attrs:{items:[{id:"",branch_name:"Select All"}].concat(Object(D.a)(e.branchesList)),dense:"",placeholder:"Select Branch",outlined:"","item-value":"id","item-text":"branch_name"},on:{change:function(t){return e.getDataFromApi()}},model:{value:e.branch_id,callback:function(t){e.branch_id=t},expression:"branch_id"}})],1):e._e(),e._v(" "),t(C.a),e._v(" "),t(r.a,{staticClass:"ma-0 px-0",attrs:{dense:"","x-small":"",ripple:!1,text:"",title:"Add LeaveGroup"}},[t(v.a,{staticClass:"ml-2",attrs:{dark:""},on:{click:function(t){return e.createNew()}}},[e._v("mdi mdi-plus-circle")])],1)],1),e._v(" "),t(w.a,{attrs:{timeout:3e3,color:e.snackColor},scopedSlots:e._u([{key:"action",fn:function(n){var o=n.attrs;return[t(r.a,e._b({attrs:{text:""},on:{click:function(t){e.snack=!1}}},"v-btn",o,!1),[e._v(" Close ")])]}}],null,!1,3090489768),model:{value:e.snack,callback:function(t){e.snack=t},expression:"snack"}},[e._v("\n          "+e._s(e.snackText)+"\n\n          ")]),e._v(" "),e.can("leave_group_view")?t(m.a,{staticClass:"elevation-1",attrs:{"item-key":"id",headers:e.headers,items:e.data,loading:e.loading,"footer-props":{itemsPerPageOptions:[10,50,100,500,1e3]}},scopedSlots:e._u([{key:"item.group_name.name",fn:function(t){var n=t.item;return[e._v("\n            "+e._s(n.group_name)+"\n          ")]}},{key:"item.leave_count",fn:function(n){var r=n.item;return e._l(r.leave_count,(function(n,r){return t("div",{key:r},[e._v("\n              "+e._s(n.leave_type.name)+" : "+e._s(n.leave_type_count)+"\n            ")])}))}},{key:"item.action",fn:function(n){var o=n.item;return[t(k.a,{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,c=n.attrs;return[t(r.a,e._g(e._b({attrs:{"dark-2":"",icon:""}},"v-btn",c,!1),o),[t(v.a,[e._v("mdi-dots-vertical")])],1)]}}],null,!0)},[e._v(" "),t(h.a,{attrs:{width:"120",dense:""}},[t(f.a,{on:{click:function(t){return e.editItem(o)}}},[t(y.c,{staticStyle:{cursor:"pointer"}},[e.can("leave_group_edit")?t(v.a,{attrs:{color:"secondary",small:""},on:{click:function(t){return e.editItem(o)}}},[e._v("\n                      mdi-pencil\n                    ")]):e._e(),e._v("\n                    Edit\n                  ")],1)],1),e._v(" "),t(f.a,{on:{click:function(t){return e.deleteItem(o)}}},[t(y.c,{staticStyle:{cursor:"pointer"}},[e.can("leave_group_delete")?t(v.a,{attrs:{color:"error",small:""},on:{click:function(t){return e.deleteItem(o)}}},[e._v("\n                      "+e._s("customer"===o.announcement?"":"mdi-delete")+"\n                    ")]):e._e(),e._v("\n                    Delete\n                  ")],1)],1)],1)],1)]}},{key:"no-data",fn:function(){},proxy:!0}],null,!1,3713419027),model:{value:e.ids,callback:function(t){e.ids=t},expression:"ids"}}):e._e()],1)],1)],1)],1):t("NoAccess")}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{NoAccess:n(881).default})},856:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n(96),o=n(0),c=Object(o.k)("v-toolbar__title"),l=Object(o.k)("v-toolbar__items");r.a},881:function(e,t,n){"use strict";n.r(t);var r=n(116),component=Object(r.a)({},(function(){this._self._c;return this._m(0)}),[function(){var e=this._self._c;return e("div",{staticClass:"text-center",staticStyle:{"margin-top":"25%"}},[e("b",[this._v("No Access")])])}],!1,null,null,null);t.default=component.exports}}]);